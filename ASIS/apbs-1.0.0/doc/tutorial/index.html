<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>APBS tutorial</title><meta name="generator" content="DocBook XSL Stylesheets V1.71.1" /></head><body><div class="book" lang="en" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="id385134"></a>APBS tutorial</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Nathan</span> <span class="surname">Baker</span></h3><div class="affiliation"><span class="orgname">Washington University in St.  Louis<br /></span> <span class="orgdiv">Department of Biochemistry and
					Molecular Biophysics<br /></span><span class="orgdiv">Center for Computational Biology<br /></span></div></div></div><div><p class="copyright">Copyright © 2002, 2003, 2004, 2005, 2006, 2007, 2008 Washington University in St.  Louis</p></div><div><div class="legalnotice"><a id="id441124"></a><p>This file is part of APBS.</p><p>
				</p><div class="literallayout"><p>Copyright (c) 2002-2008, Washington University in St. Louis.<br />
Portions Copyright (c) 2002-2008.  Nathan A. Baker<br />
Portions Copyright (c) 1999-2002.  The Regents of the University of California.<br />
Portions Copyright (c) 1995.  Michael Holst.</p></div><p> All rights reserved. </p><p> Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
				</p><div class="itemizedlist"><ul type="disc"><li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li><li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li><li> Neither the name of Washington University in St. Louis nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li></ul></div><p>
			</p><p> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p></div></div></div><hr /></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#introduction-sect">1. How to read this tutorial</a></span></dt><dt><span class="chapter"><a href="#pdb2pqr-sect">2. How do I get my structure ready for
			electrostatics calculations?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#pqr-format-sect">2.1. PQR format</a></span></dt><dt><span class="sect1"><a href="#xml-format-sect">2.2. XML format</a></span></dt><dt><span class="sect1"><a href="#pdb2pqr-subsect">2.3. Generating PQR files from PDB
				files (PDB2PQR)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#viz-sect">3. How do I visualize the electrostatic
potential around my biomolecule?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#vmd-sect">3.1. VMD</a></span></dt><dt><span class="sect1"><a href="#pymol-sect">3.2. PyMOL</a></span></dt><dt><span class="sect1"><a href="#pmv-sect">3.3. PMV</a></span></dt></dl></dd><dt><span class="chapter"><a href="#solvation-sect">4. How do I calculate a solvation energy?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id442664">4.1. Polar solvation</a></span></dt><dt><span class="sect1"><a href="#id442864">4.2. Apolar solvation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#binding-sect">5. How do I calculate a binding energy?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#binding-solvation">5.1.  Solvation energy contributions to binding
			</a></span></dt><dt><span class="sect1"><a href="#binding-coulombic">5.2. Including Coulombic contributions</a></span></dt><dt><span class="sect1"><a href="#binding-ligand">5.3. Hey! You don't have any parameters for my ligand!</a></span></dt><dt><span class="sect1"><a href="#binding-example">5.4. A ligand binding example</a></span></dt></dl></dd><dt><span class="chapter"><a href="#forces-sect">6. How do I calculate solvation
forces?</a></span></dt><dt><span class="chapter"><a href="#pka-sect">7. How do I calculate a pK<sub>a</sub>?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#overview-sect">7.1. Overview</a></span></dt><dt><span class="sect1"><a href="#pka-introduction-sect">7.2. Introduction</a></span></dt><dt><span class="sect1"><a href="#id444444">7.3. Application to lysozyme</a></span></dt></dl></dd><dt><span class="chapter"><a href="#parallel-sect">8. My calculation requires too much memory!</a></span></dt><dd><dl><dt><span class="sect1"><a href="#parallel">8.1. Parallel calculations:  an example</a></span></dt><dt><span class="sect1"><a href="#async">8.2. Asynchronous sequential calculations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#simulation-sect">9. How do I use APBS with my
molecular dynamics program (for MM/PBSA, etc.)?</a></span></dt><dt><span class="chapter"><a href="#gemstone-sect">10. Can I run APBS via the web?  (Gemstone) </a></span></dt><dd><dl><dt><span class="sect1"><a href="#id446166">10.1. Getting Gemstone</a></span></dt><dt><span class="sect1"><a href="#id446191">10.2. Preparing a structure with PDB2PQR</a></span></dt><dt><span class="sect1"><a href="#id446302">10.3. Perform an electrostatics calculation with APBS</a></span></dt></dl></dd><dt><span class="chapter"><a href="#more-sect">11. More examples...</a></span></dt><dt><span class="chapter"><a href="#help-sect">12. None of this answered my question...</a></span></dt></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>3.1. <a href="#id441954">Arc repressor isocontours in VMD</a></dt><dt>3.2. <a href="#id442125">Arc repressor surface potential in VMD</a></dt><dt>3.3. <a href="#id442480">+/- 1 kT/e
							electrostatic potential
							isocontours of FAS2 in PyMOL</a></dt><dt>3.4. <a href="#id442579">+/- 5 kT/e
							electrostatic surface potential
							of FAS2 in PyMOL</a></dt><dt>4.1. <a href="#solvation-cycle-full">Full
					solvation energy cycle</a></dt><dt>5.1. <a href="#binding-cycle"> Binding free energy cycle
				</a></dt><dt>7.1. <a href="#fig:pKa_cycle_protein">pK<sub>a</sub> perturbation free energy cycle schematic</a></dt><dt>7.2. <a href="#id444515">Active site of HEWL </a></dt><dt>8.1. <a href="#id445904">Actin dimer isocontours from
parallel focusing</a></dt><dt>10.1. <a href="#id446273">Gemstone PDB2PQR calculation</a></dt><dt>10.2. <a href="#id446362">Gemstone APBS/Calculation screen</a></dt><dt>10.3. <a href="#id446409">Gemstone APBS/Grid screen</a></dt><dt>10.4. <a href="#id446444">Gemstone APBS/Physics screen</a></dt><dt>10.5. <a href="#id446478">Gemstone APBS/File I/O screen</a></dt><dt>10.6. <a href="#id446506">Gemstone APBS/Calculation screen (run complete)</a></dt></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>7.1. <a href="#tab:model_pka">Model amino acid pK<sub>a</sub> values for common titratable groups; data from Nielsen et al (see footnote) </a></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>4.1. <a href="#born-pqr">Born ion PQR</a></dt><dt>4.2. <a href="#born-input">Example born input file</a></dt></dl></div><div class="list-of-equations"><p><b>List of Equations</b></p><dl><dt>4.1. <a href="#born-solvation-energy-equation">Born ion polar solvation energy</a></dt><dt>5.1. <a href="#binding-cycle-eqn"> Binding free energy formula
				</a></dt><dt>5.2. <a href="#binding-solvation-eq"> Solvation contributions to the binding
						free energy </a></dt><dt>5.3. <a href="#binding-coulomb-eq"> Coulombic contributions to the binding
						free energy </a></dt><dt>5.4. <a href="#binding-cycle-eqn-2"> Binding free energy </a></dt><dt>7.1. <a href="#eqn:DaG">Acid dissociation free energy</a></dt><dt>7.2. <a href="#eqn:dG_xfer">Transfer free energy</a></dt></dl></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="introduction-sect"></a>Chapter 1. How to read this tutorial</h2></div></div></div><p>This tutorial is designed as a "how to" document to get
			users acquainted with computational electrostatics
			calculations using APBS.  In order to perform the
			provided examples, you will need the latest version of
			APBS (<a href="http://apbs.sf.net" target="_top">http://apbs.sf.net</a>).  Other
			requirements are listed in the individual
			sections.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png" /></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Note that many of the examples in this tutorial
				can also be run through the web-based <a href="http://gemstone.mozdev.org/" target="_top">Gemstone</a>
				service without the need for local
				installations of the APBS software.  More
				information is available in <a href="#gemstone-sect" title="Chapter 10. Can I run APBS via the web?  (Gemstone) ">Chapter 10, <i>Can I run APBS via the web?  (Gemstone) </i></a>.
			</p></td></tr></table></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p> This document is still under construction and should be completed before the next APBS release.  Many of the topics covered in the incomplete sections are demonstrated in the APBS <code class="filename">examples</code> directory.
			</p></td></tr></table></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="pdb2pqr-sect"></a>Chapter 2. How do I get my structure ready for
			electrostatics calculations?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#pqr-format-sect">2.1. PQR format</a></span></dt><dt><span class="sect1"><a href="#xml-format-sect">2.2. XML format</a></span></dt><dt><span class="sect1"><a href="#pdb2pqr-subsect">2.3. Generating PQR files from PDB
				files (PDB2PQR)</a></span></dt></dl></div><p>
			In order to perform electrostatics calculations on your
			biomolecular structure of interest, you need to provide
			atomic charge and radius information to APBS.  Charges
			are used to form the biomolecular charge distribution
			for the Poisson-Boltzmann (PB) equation while the radii
			are used to construct the dielectric and ionic
			accessibility functions.  This charge and radius
			information can be provided to APBS in a few different
			formats which are described in more detail below.
		</p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pqr-format-sect"></a>2.1. PQR format</h2></div></div></div><p>
				The <a href="../user-guide/index.html#pqr-format" target="_top">PQR
					format</a> provides a very simple
				way to include parameter information by 
				by replacing the occupancy and temperature
				columns of a PDB-format structure file with 
				charge ("Q") and radius ("R") information.
				Unfortunately, the simplicity of this format
				also limits its extensibility:  it can be very
				difficult to add new atom types and parameters
				in a generic format without the use of external
				software such as <a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a>.
				The XML parameter format described <a href="#xml-format-sect" title="2.2. XML format">below</a>
				is much easier to modify.
			</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="xml-format-sect"></a>2.2. XML format</h2></div></div></div><p>The <a href="../user-guide/index.html#pqr-xml-format" target="_top">XML format</a> provides a somewhat more complicated format for including parameter information with increased flexibility in formatting, extension, and other modifications.  As in the PQR format, atom coordinates are supplemented with charge and radius information.  Please see <a href="../user-guide/index.html#pqr-xml-format" target="_top">the APBS user guide</a> for complete format specifications.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pdb2pqr-subsect"></a>2.3. Generating PQR files from PDB
				files (PDB2PQR)</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial was prepared using PDB2PQR 1.2.1</p></td></tr></table></div><p>
				The <a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a> web service and software will convert
				most PDB files into PQR format with some caveats, in particular the inability to "repair" large regions of missing coordinates.
				Although PDB2PQR can fix some missing heavy atoms in sidechains, it does not currently have the (nontrivial) capability to model in large regions of missing backbone and sidechain coordinates.
			</p><p>
				<a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a> will also perform hydrogen bond optimization,  sidechain rotamer search, limited titration state assignment, ligand parameterization, and APBS input file preparation.
				Please see <a href="http://pdb2pqr.sf.net/" target="_top">http://pdb2pqr.sf.net/</a> for more details.
			</p><p>
				As mentioned above, PDB2PQR is discussed in
				more detailed on the 
				<a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR
					homepage</a> .  Therefore, we will
				review the minimal steps required to produce a
				PQR file from a PDB file here.  To begin,
				choose a server from <a href="http://pdb2pqr.sf.net/#availability" target="_top">http://pdb2pqr.sf.net/#availability</a>.
			</p><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441418"></a>2.3.1. Choose the PDB file to convert</h3></div></div></div><p>
					Either enter the 4-character <a href="http://www.pdb.org/" target="_top">PDB</a>
					ID or accession number (e.g., <a href="http://www.pdb.org/pdb/explore.do?structureId=1FAS" target="_top">1FAS</a>,
					<a href="http://www.pdb.org/pdb/explore.do?structureId=1MAH" target="_top">1MAH</a>,
					<a href="http://www.pdb.org/pdb/explore.do?structureId=1LYS" target="_top">1LYS</a>,
					etc.) or upload your own PDB file.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> Note that, if you choose
							to enter a 4-character
							PDB file, PDB2PQR will
							process 
							<span class="emphasis"><em>all
								recognizable 
								chains</em></span> 
							of PDB file
							<span class="emphasis"><em>as it was
								deposited</em></span>
							in the PDB (e.g., not 
							the biological unit,
							any related
							transformations, etc.).
						</p></td></tr></table></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="pdb2pqr-ff-sect"></a>2.3.2. Pick a forcefield</h3></div></div></div><p>
					<span class="emphasis"><em>For most applications, the choice is
						easy:  PARSE.</em></span>  This
					forcefield has been optimized for
					implicit solvent calculation and is
					probably the best choice for
					visualization of protein electrostatics
					and many common types of energetic
					calculations for proteins.  However,
					AMBER and CHARMM may be more
					appropriate if you are attempting to
					compare directly to simulations
					performed with those force fields,
					require nucleic acid support, are
					simulating ligands parameterized with
					those force fields, etc.
				</p><p>
					It is also possible to upload a
					user-defined forcefield (e.g., to
					define radii and charges for ligands or
					unusual residues).  Please see the
					<a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a>
					documentation for more information.
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441506"></a>2.3.3. Output naming scheme</h3></div></div></div><p>This is largely irrelevant to
					electrostatics calculations but may be
					important for visualization.  When in
					doubt, choose the "Internal naming
					scheme" which attempts to conform to
					IUPAC standards.</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441519"></a>2.3.4. Other options</h3></div></div></div><p>These options fall into two categories:
					how to build missing atoms (including
					hydrogens) onto the structure and
					additional output configuration. 
					Please see <a href="http://pdb2pqr.sf.net/" target="_top">http://pdb2pqr.sf.net/</a> for more details.
				</p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="viz-sect"></a>Chapter 3. How do I visualize the electrostatic
potential around my biomolecule?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#vmd-sect">3.1. VMD</a></span></dt><dt><span class="sect1"><a href="#pymol-sect">3.2. PyMOL</a></span></dt><dt><span class="sect1"><a href="#pmv-sect">3.3. PMV</a></span></dt></dl></div><p> There are a number of excellent molecular graphics
			programs which can be used to visualize electrostatic
			properties in the context of the biomolecule.  Since
			there are far too many to review in any depth, we will
			focus on the 3 packages with which we are most
			familiar. </p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="vmd-sect"></a>3.1. VMD</h2></div></div></div><p>
				The <a href="http://www.ks.uiuc.edu/Research/vmd/" target="_top">VMD</a> molecular
				graphics software package provides support for
				both the execution of APBS and the
				visualization of the resulting electrostatic
				potentials.  Documentation on the APBS
				interface has been provided by the VMD
				developers at <a href="http://www.ks.uiuc.edu/Research/vmd/plugins/apbsrun/" target="_top">http://www.ks.uiuc.edu/Research/vmd/plugins/apbsrun/</a>.
				We will supplement this with a basic
				demonstration of how go from a PDB entry to a
				plot of structure &amp; potential in VMD using
				APBS.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial was written using VMD
					1.8.5.</p></td></tr></table></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441600"></a>3.1.1. Generating the PQR</h3></div></div></div><p> 
					We'll perform this example with arc
					repressor
					(PDB ID <a href="http://www.pdb.org/pdb/explore.do?structureId=1MYK" target="_top">1MYK</a>),
					a DNA binding protein.  The first step
					in the visualization process is
					generating a PQR file for use with VMD
					and APBS.  Please follow the directions
					in <a href="#pdb2pqr-subsect" title="2.3. Generating PQR files from PDB&#10;&#9;&#9;&#9;&#9;files (PDB2PQR)">Section 2.3, “Generating PQR files from PDB
				files (PDB2PQR)”</a> to
					generate a PQR file for this structure.
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441626"></a>3.1.2. Loading the PQR</h3></div></div></div><p>
					Load the PQR file you just created into
					VMD (<span class="guimenu">File</span> → <span class="guimenuitem">New molecule...</span> in the VMD Main window).
					Adjust the molecule to the desired
					view.
					Depending on the force
					field<sup>[<a id="id441653" href="#ftn.id441653">1</a>]</sup>
					you used in PDB2PQR, you may notice
					that VMD is displaying some strange
					bonds.  When a PQR file is loaded into
					VMD, bond distances are inferred from
					the PQR radii.  These radii were chosen
					for continuum electrostatics
					calculations, not visualization.  Don't
					worry if some of the bonds appear a bit
					strange (hide the hydrogens if it
					really bothers you).
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441668"></a>3.1.3. Running the electrostatics calculation</h3></div></div></div><p>
					You're now ready for electrostatics
					calculations.  
					</p><div class="orderedlist"><ol type="1"><li><p>Choose
								<span class="guimenu">Extensions</span> → <span class="guisubmenu">Analysis</span> → <span class="guimenuitem">APBS
										electrostatics</span>
								in the VMD Main
								window.  A new
								APBS Tool
								window should
								appear.
							</p></li><li><p>Choose 
								<span class="guimenu">Edit</span> → <span class="guimenuitem">Settings...</span> 
								in the APBS
								Tool window and
								set the path to
								your local copy
								of the APBS
								executable.
								Hit
								<span class="guibutton">OK</span>
								to close this
								window.
							</p></li><li><p>Select the "0"
								calculation
								from the
								"<span class="guilabel">Individual
									PB
									calculations
									(ELEC):</span>"
								window.  Hit 
								the
								<span class="guibutton">Edit</span>
								button.  Adjust
								the APBS
								settings here
								as you desire.
								The defaults
								are usually
								fine, although
								it may be
								useful to edit
								the ions to
								adjust the
								ionic strength
								used in the
								calculation.
								Hit
								<span class="guibutton">OK</span>
								when you're
								done.
							</p></li><li><p>You're now ready
								to run the
								calculation.
								Hit
								<span class="guibutton">Run
									APBS</span>
								in the APBS
								Tool window.
								Check the VMD
								Console window
								for information
								about the job
								while it's
								running.  When
								the job is
								finished, a
								"APBSRun: Load
								APBS Maps"
								window should
								appear.  Select
								"<span class="guibutton">Load
									files
									into
									top
									molecule</span>"
								and hit
								<span class="guibutton">OK</span>.
							</p></li></ol></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id441814"></a>3.1.4. Electrostatics visualization</h3></div></div></div><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="vmd-isocontour"></a>3.1.4.1. Isocontour visualization</h4></div></div></div><p>
						One of the most popular
						visualization methods is the
						isocontour.
					</p><div class="orderedlist"><ol type="1"><li><p>First, choose <span class="guimenu">Graphics</span> → <span class="guimenuitem">Representations...</span>
								from the VMD
								Main window.
							</p></li><li><p>
								Hit the
								<span class="guibutton">Create
									Rep</span>
								button and
								change
								<span class="guilabel">Drawing
									Method</span>
								to
								"Isosurface".
							</p></li><li><p>
								Change
								<span class="guilabel">Draw</span>
								from "Points"
								to "Solid
								Surface" and
								<span class="guilabel">Material</span>
								to
								"Transparent". 
							</p></li><li><p>
								Note that the
								current
								isovalue is 0;
								change this to
								1 (or 5 or 10
								or whatever)
								depending on
								your personal
								preferences.
							</p></li><li><p>
								To continue the
								lonstanding
								tradition of
								electrostatic
								potential
								coloring,
								choose "ColorID
								0" for the
								<span class="guilabel">Coloring
									Method</span>.
							</p></li><li><p>
								For the
								negative
								isocontour, hit
								"<span class="guibutton">Create
									Rep</span>"
								and select the
								newly created
								representation.
								Change the
								isocontour
								value to -1 (or
								5 or 10...) and
								the ColorID to
								1.
							</p></li></ol></div><p>
						At this point, you probably
						have an image that looks
						something like this (note that
						I changed the surface to points
						to make the figure a bit
						cleaner):
						</p><div class="figure"><a id="id441954"></a><p class="title"><b>Figure 3.1. Arc repressor isocontours in VMD</b></p><div class="figure-contents"><div><img src="images/arc-iso-vmd.png" alt="Arc repressor isocontours in VMD" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id441970"></a>3.1.4.2. Visualizing surface potentials</h4></div></div></div><p>
						Another popular method of
						electrostatic potential
						visualization maps the
						electrostatic potential to the
						biomolecular surface.  Before
						proceeding, you may want to
						delete the two isocontours you
						just created using the
						<span class="guibutton">Delete
							Rep</span> in the
						Graphical Representations
						window.
					</p><div class="orderedlist"><ol type="1"><li><p>
								Go to the
								Graphical
								Representations
								window
								(<span class="guimenu">Graphics</span> → <span class="guimenuitem">Representations...</span>
								from the VMD
								Main window)
								and create a
								new
								representation
								of the molecule
								with the 
								<span class="guibutton">Create
									Rep</span>
								button.
							</p></li><li><p> Go to the "Draw
								style" tab of
								the Graphical
								Representations
								window and
								change
								<span class="guilabel">Drawing
									Method</span>
								to
								"Surf"<sup>[<a id="id442044" href="#ftn.id442044">2</a>]</sup>
								and
								<span class="guilabel">Coloring
									Method</span>
								to "Volume".
							</p></li><li><p>
								Go to the
								"Trajectory
								tab" of the
								Graphical
								Representations
								window
								and change the
								"<span class="guilabel">Color
									Scale
									Data
									Range:</span>"
								to -10 to 10
								(or whatever
								your favorite
								values are).
							</p></li><li><p>
								Based on your
								version of VMD
								and your
								personal
								preferences,
								you might want
								to change the
								color scale for
								this image.  Go
								to <span class="guimenu">Graphics</span> → <span class="guimenuitem">Colors...</span>
								in the VMD Main
								window and
								select the
								"Color Scale"
								tab from the
								new "Color
								Controls"
								window.  The
								traditional
								coloring scheme
								for
								electrostatics
								is "RWB" (in
								the
								<span class="guilabel">Method</span>
								menu).
							</p></li></ol></div><p>
						Your molecule now probably
						looks like this:
						</p><div class="figure"><a id="id442125"></a><p class="title"><b>Figure 3.2. Arc repressor surface potential in VMD</b></p><div class="figure-contents"><div><img src="images/arc-surf-vmd.png" alt="Arc repressor surface potential in VMD" /></div></div></div><p><br class="figure-break" />
					</p></div></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pymol-sect"></a>3.2. PyMOL</h2></div></div></div><p>
				The <a href="http://pymol.sf.net" target="_top">PyMOL</a> molecular
				graphics software package provides support for
				both the execution of APBS and the
				visualization of the resulting electrostatic
				potentials.  We will provide a basic
				demonstration of how go from a PDB entry to a
				plot of structure &amp; potential in PyMOL using
				APBS.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial was written using
					PyMOLX11Hybrid 0.99 on a Mac.</p></td></tr></table></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id442172"></a>3.2.1. Generating the PQR</h3></div></div></div><p>We'll perform this example with
					fasciculin-2 (PDB ID <a href="http://www.pdb.org/pdb/explore.do?structureId=1FAS" target="_top">1FAS</a>),
					a snake neurotoxin which binds the
					negatively-charged
					acetylcholinesterase.  Please generate
					the PQR file using the steps outlined
					in <a href="#pdb2pqr-subsect" title="2.3. Generating PQR files from PDB&#10;&#9;&#9;&#9;&#9;files (PDB2PQR)">Section 2.3, “Generating PQR files from PDB
				files (PDB2PQR)”</a>.
				</p><p>Load the PQR file you created into PyMOL
					(<span class="guimenu">File</span> → <span class="guimenuitem">Open...</span>) and choose your favorite
					graphical representation.</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id442217"></a>3.2.2. Performing the electrostatics calcuation
					</h3></div></div></div><p>
					Go to the 
					<span class="guimenu">Plugin</span> → <span class="guimenuitem">APBS
							Tools...</span>
					to open the APBS calculation plugin.
					</p><div class="orderedlist"><ol type="1"><li><p>
								Under the
								"<span class="guilabel">Main</span>"
								tab of the
								PyMOL APBS
								Tools window,
								select
								<span class="guibutton">Use
									another
									PQR</span>
								and either
								browse to (via
								the
								<span class="guibutton">Choose
									Externally
									Generated
									PQR:</span>
								button) or input the
								path to your
								PQR file.  This
								step is
								necessary to
								ensure you use
								the radii and
								charges
								assigned by
								PDB2PQR.
							</p></li><li><p>
								Under the
								"<span class="guilabel">APBS
									Location</span>"
								tab of the
								PyMOL APBS
								Tools window,
								either browse
								to (via the
								<span class="guibutton">APBS
									binary
									location:
									:</span>
								button) or input the
								path to your
								local APBS
								binary.  It is
								not necessary
								to provide a
								path to the
								APBS psize.py
								binary for most
								biomolecules.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Temporary
									File
									Locations</span>"
								tab of the
								PyMOL APBS
								Tools window,
								customize the
								locations of
								the various
								temporary files
								created during
								the run.  This
								can be useful
								if you want to
								save the
								generated files
								for later use.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Configuration</span>"
								tab of the
								PyMOL APBS
								Tools window,
								hit the
								<span class="guibutton">Set
									grid</span>
								to set the grid
								spacings.
								The default
								values are
								usually
								sufficient for
								all but the
								most highly
								charged
								biomolecules.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Configuration</span>"
								tab of the
								PyMOL APBS
								Tools window,
								customize the
								remaining
								parameters; the
								defaults are
								usually
								OK<sup>[<a id="id442362" href="#ftn.id442362">3</a>]</sup>.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Configuration</span>"
								tab of the
								PyMOL APBS
								Tools window,
								hit the
								<span class="guibutton">Run
									APBS</span>
								button to start
								the APBS
								calculation.
								Depending on
								the speed of
								your computer,
								this could take
								a few minutes.
								The
								<span class="guibutton">Run
									APBS</span>
								button will
								become
								unselected when
								the calculation
								is finished.
							</p></li></ol></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id442409"></a>3.2.3. Visualize the electrostatic potential</h3></div></div></div><p> Before proceeding with the remaining
					steps, you must load the electrostatic
					potential data into PyMOL.  Under the
					"<span class="guilabel">Visualization</span>"
					tab of the PyMOL APBS Tools window, hit
					the <span class="guibutton">Update</span>
					button.  </p><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id442433"></a>3.2.3.1. Electrostatic isocontours</h4></div></div></div><p>PyMOL makes this step very easy:
						adjust the positive and
						negative
						"<span class="guilabel">Contour</span>"
						fields to the desired values
						(usually +/-1, +/-5, or +/-10
						kT/e<sup>[<a id="id442450" href="#ftn.id442450">4</a>]</sup>)
						and hit the 
						<span class="guilabel">Positive Isosurface</span>
						and <span class="guilabel">Negative Isosurface</span>
						and <span class="guibutton">Show</span>
						buttons.
					</p><p>
						At this point, you probably
						have a figure that looks
						something like:
						</p><div class="figure"><a id="id442480"></a><p class="title"><b>Figure 3.3. +/- 1 kT/e
							electrostatic potential
							isocontours of FAS2 in PyMOL</b></p><div class="figure-contents"><div><img src="images/fas2-iso-pymol.png" alt="+/- 1 kT/e electrostatic potential isocontours of FAS2 in PyMOL" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id442497"></a>3.2.3.2. Surface potentials</h4></div></div></div><p>If you haven't already, hide the
						isocontours by hitting
						<span class="guilabel">Positive Isosurface</span>
						and <span class="guilabel">Negative Isosurface</span>
						and <span class="guibutton">Hide</span>
						buttons.
					</p><p>The surface potential is also
						straightforward to visualize.
						Set the 
						"<span class="guilabel">Low</span>"
						and
						"<span class="guilabel">High</span>"
						values to the desired values 
						(usually +/-1, +/-5, or +/-10
						kT/e) at which the surface
						colors are clamped at red (-)
						or blue (+).  Check the
						"<span class="guibutton">Solvent accessible
							surface</span>"
						and "<span class="guibutton">Color by
							potential on sol. acc.
							surf.</span>"
						buttons to plot the potential
						on the solvent-accessible
						(probe-inflated or
						Lee-Richards)
						surface<sup>[<a id="id442559" href="#ftn.id442559">5</a>]</sup>.
						Hit the "<span class="guilabel">Molecular
							Surface</span>"
						<span class="guibutton">Show</span>
						button to load the surface
						potential.
						</p><div class="figure"><a id="id442579"></a><p class="title"><b>Figure 3.4. +/- 5 kT/e
							electrostatic surface potential
							of FAS2 in PyMOL</b></p><div class="figure-contents"><div><img src="images/fas2-surf-pymol.png" alt="+/- 5 kT/e electrostatic surface potential of FAS2 in PyMOL" /></div></div></div><p><br class="figure-break" />
					</p></div></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pmv-sect"></a>3.3. PMV</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction -- surfaces are
					currently broken with some PQR
					structure/force field
					combinations.</p></td></tr></table></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div class="footnote"><p><sup>[<a id="ftn.id441653" href="#id441653">1</a>] </sup>Visualization
							seems to work best with
							PARSE</p></div><div class="footnote"><p><sup>[<a id="ftn.id442044" href="#id442044">2</a>] </sup>FYI,
										this
										appears
										to
										generate
										a
										molecular
										or
										Connolly
										type
										of
										surface
										rather
										than
										the
										solvent-accessible
										or
										Lee-Richards
										surface
										I
										personally
										prefer
										for
										this
										type
										of
										visualization...</p></div><div class="footnote"><p><sup>[<a id="ftn.id442362" href="#id442362">3</a>] </sup>Although
										I
										usually
										prefer
										0.150
										concentrations
										for
										the
										+1
										and
										-1
										ion
										species
										so
										electrostatic
										properties
										aren't
										overly
										exaggerated.</p></div><div class="footnote"><p><sup>[<a id="ftn.id442450" href="#id442450">4</a>] </sup>Note that
								PyMOL has a
								slight units
								error on the
								contour
								values.</p></div><div class="footnote"><p><sup>[<a id="ftn.id442559" href="#id442559">5</a>] </sup>In my opinion,
								the
								solvent-accessible
								surface tends
								to reveal more
								global features
								of the surface
								potential.
								Tighter
								surfaces (e.g.,
								van der Waals
								and molecular
								or Connolly
								surfaces) tend
								to simply map
								atomic surface charges
								onto the
								biomolecular
								surface.</p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="solvation-sect"></a>Chapter 4. How do I calculate a solvation energy?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id442664">4.1. Polar solvation</a></span></dt><dt><span class="sect1"><a href="#id442864">4.2. Apolar solvation</a></span></dt></dl></div><p>
			Solvation energies are usually decomposed into a free
			energy cycle as shown in <a href="#solvation-cycle-full" title="Figure 4.1. Full solvation energy cycle.  This cycle incorporates several processes into the solvation energy (step 1).  Step 2  indicates charging of the solute in solution (e.g., inhomogeneous dielectric,  ions present).  Step 3 indicates the introduction of attractive solute-solvent dispersive interaction interactions (e.g., an integral of Weeks-Chandler-Andersen interactions over the solvent-accessible volume).  Step 4 indicates the introduction of repulsive solute-solvent interaction (e.g., cavity formation).  Steps 5 and 6 are basically null steps although they could be used to offset unwanted energies added in Steps 3 and 4 above.  Finally, Step 6 represents the charging of the solute in a vacuum or homogeneous dielectric environment in the absence of mobile ions.">Figure 4.1, “Full
					solvation energy cycle”</a>.  Note that
			such solvation energies often performed on fixed
			conformations; as such, they are more correctly called
			"potentials of mean force".  More details on using APBS
			for the polar and nonpolar portions of such a cycle are
			given in the following sections.
			</p><div class="figure"><a id="solvation-cycle-full"></a><p class="title"><b>Figure 4.1. Full solvation energy cycle.  This cycle incorporates several processes into the solvation energy (step 1).  Step 2  indicates charging of the solute in solution (e.g., inhomogeneous dielectric,  ions present).  Step 3 indicates the introduction of attractive solute-solvent dispersive interaction interactions (e.g., an integral of Weeks-Chandler-Andersen interactions over the solvent-accessible volume).  Step 4 indicates the introduction of repulsive solute-solvent interaction (e.g., cavity formation).  Steps 5 and 6 are basically null steps although they could be used to offset unwanted energies added in Steps 3 and 4 above.  Finally, Step 6 represents the charging of the solute in a vacuum or homogeneous dielectric environment in the absence of mobile ions.</b></p><div class="figure-contents"><div><img src="images/solvation-cycle-full.png" alt="Full solvation energy cycle. This cycle incorporates several processes into the solvation energy (step 1). Step 2 indicates charging of the solute in solution (e.g., inhomogeneous dielectric, ions present). Step 3 indicates the introduction of attractive solute-solvent dispersive interaction interactions (e.g., an integral of Weeks-Chandler-Andersen interactions over the solvent-accessible volume). Step 4 indicates the introduction of repulsive solute-solvent interaction (e.g., cavity formation). Steps 5 and 6 are basically null steps although they could be used to offset unwanted energies added in Steps 3 and 4 above. Finally, Step 6 represents the charging of the solute in a vacuum or homogeneous dielectric environment in the absence of mobile ions." /></div></div></div><p><br class="figure-break" />
		</p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id442664"></a>4.1. Polar solvation</h2></div></div></div><p> The full free energy cycle in <a href="#solvation-cycle-full" title="Figure 4.1. Full solvation energy cycle.  This cycle incorporates several processes into the solvation energy (step 1).  Step 2  indicates charging of the solute in solution (e.g., inhomogeneous dielectric,  ions present).  Step 3 indicates the introduction of attractive solute-solvent dispersive interaction interactions (e.g., an integral of Weeks-Chandler-Andersen interactions over the solvent-accessible volume).  Step 4 indicates the introduction of repulsive solute-solvent interaction (e.g., cavity formation).  Steps 5 and 6 are basically null steps although they could be used to offset unwanted energies added in Steps 3 and 4 above.  Finally, Step 6 represents the charging of the solute in a vacuum or homogeneous dielectric environment in the absence of mobile ions.">Figure 4.1, “Full
					solvation energy cycle”</a> is
				usually decomposed into polar and nonpolar
				parts.  The polar portion is usually
				represented by the charging energies in Steps 2
				and 6:
				</p><div class="informalequation"><div><img src="images/polar-solvation-equation.png" /></div></div><p>
				Energies returned from APBS electrostatics
				calculations are charging free energies.
				Therefore, to calculate the polar contribution
				to the solvation free energy, we simply need to
				setup two calculations corresponding to Steps 2
				and 6 in <a href="#solvation-cycle-full" title="Figure 4.1. Full solvation energy cycle.  This cycle incorporates several processes into the solvation energy (step 1).  Step 2  indicates charging of the solute in solution (e.g., inhomogeneous dielectric,  ions present).  Step 3 indicates the introduction of attractive solute-solvent dispersive interaction interactions (e.g., an integral of Weeks-Chandler-Andersen interactions over the solvent-accessible volume).  Step 4 indicates the introduction of repulsive solute-solvent interaction (e.g., cavity formation).  Steps 5 and 6 are basically null steps although they could be used to offset unwanted energies added in Steps 3 and 4 above.  Finally, Step 6 represents the charging of the solute in a vacuum or homogeneous dielectric environment in the absence of mobile ions.">Figure 4.1, “Full
					solvation energy cycle”</a>.
				However, the electrostatic charging free
				energies returned by APBS include
				self-interaction terms.  These are the energies
				of a charge distribution interacting with
				itself.  Such self-interaction energies are
				typically very large and extremely sensitive to
				the problem discretization (grid spacing,
				location, etc.).  Therefore, it is very
				important that the two calculations are
				performed with identical grid spacings,
				lengths, and centers, in order to ensure
				appropriate matching (or "cancellation") of
				self-energy terms.
			</p><p> One of the canonical examples for polar
				solvation is the Born ion:  a nonpolarizable
				sphere with a single charge at its center
				surrounded by an aqueous medium.  In the
				absence of external ions, the polar solvation
				energy for this sytem is given by <a href="#born-solvation-energy-equation" title="Equation 4.1. Born ion polar solvation energy.&#10;&#9;&#9;&#9;&#9;&#9;q is the ion charge, a is the ion&#10;radius, and the two epsilons denote the internal and external (solution)&#10;dielectric constants.  This model assumes zero ionic strength.">Equation 4.1, “Born ion polar solvation energy”</a>.
				</p><div class="equation"><a id="born-solvation-energy-equation"></a><p class="title"><b>Equation 4.1. Born ion polar solvation energy.
					q is the ion charge, a is the ion
radius, and the two epsilons denote the internal and external (solution)
dielectric constants.  This model assumes zero ionic strength.</b></p><div class="equation-contents"><div><img src="images/born-solvation-energy-equation.png" /></div></div></div><p><br class="equation-break" />
				We can setup a PQR file for the Born ion for
				use with APBS as shown in <a href="#born-pqr" title="Example 4.1. Born ion PQR">Example 4.1, “Born ion PQR”</a> and downloaded
				<a href="examples/born/born.pqr" target="_top">here</a>.
				</p><div class="example"><a id="born-pqr"></a><p class="title"><b>Example 4.1. Born ion PQR</b></p><div class="example-contents"><pre class="programlisting">
REMARK  This is an ion with a 3 A radius and a +1 e charge
ATOM      1   I  ION     1 0.000   0.000   0.000  1.00 3.00
					</pre></div></div><p><br class="example-break" />
				We're interested in performing two APBS
				calculations for the charging free energies in
				homogeneous and heterogeneous dielectric
				coefficients.  We'll assume the internal
				dielectric coefficient is 1 (e.g., a vacuum)
				and the external dielectric coefficient is
				78.54 (e.g., water).
				for these settings, the polar solvation energy
				expression has the form
				</p><div class="informalequation"><div><img src="images/born-solvation-energy-equation2.png" /></div></div><p>
				where R is the ion radius
				in Angstroms.  One possible APBS input file for
				this calculation is shown in <a href="#born-input" title="Example 4.2. Example born input file">Example 4.2, “Example born input file”</a> and can be
				downloaded <a href="examples/born/born.in" target="_top">here</a>.
				</p><div class="example"><a id="born-input"></a><p class="title"><b>Example 4.2. Example born input file</b></p><div class="example-contents"><pre class="programlisting">
# READ IN MOLECULES
read
  mol pqr born.pqr
end


elec name solv # Electrostatics calculation on the solvated state
	mg-manual # Specify the mode for APBS to run
	dime 97 97 97 # The grid dimensions
	nlev 4 # Multigrid level parameter
	grid 0.33 0.33 0.33 # Grid spacing
	gcent mol 1 # Center the grid on molecule 1
	mol 1 # Perform the calculation on molecule 1
	lpbe # Solve the linearized Poisson-Boltzmann equation
	bcfl mdh # Use all multipole moments when calculating the potential
	pdie 1.0 # Solute dielectric
	sdie 78.54 # Solvent dielectric
	chgm spl2 # Spline-based discretization of the delta functions
	srfm mol # Molecular surface definition
	srad 1.4 # Solvent probe radius (for molecular surface)
	swin 0.3 # Solvent surface spline window (not used here)
	sdens 10.0 # Sphere density for accessibility object
	temp 298.15 # Temperature
	calcenergy total # Calculate energies
	calcforce no # Do not calculate forces
end

elec name ref # Calculate potential for reference (vacuum) state
	mg-manual
	dime 97 97 97
	nlev 4
	grid 0.33 0.33 0.33
	gcent mol 1
	mol 1
	lpbe
	bcfl mdh
	pdie 1.0
	sdie 1.0
	chgm spl2
	srfm mol
	srad 1.4
	swin 0.3
	sdens 10.0
	temp 298.15
	calcenergy total
	calcforce no
end

# Calculate solvation energy
print energy solv - ref end

quit
					</pre></div></div><p><br class="example-break" />
				Running this example with a recent version of
				APBS should give an answer of -229.59 kJ/mol
				which is in good agreement with the -230.62
				kJ/mol predicted by the analytic formula above.
			</p><p> 
				Note that the Born example above can be easily
				generalized to other polar solvation energy
				calculations.  For example, ions could be added
				to the <code class="literal">solv</code>
				<code class="varname">ELEC</code> section, dielectric
				constants could be modified, surface
				definitions could be changed (in both
				<code class="varname">ELEC</code> sections!), or more
				complicated molecules could be examined.  Many
				of the examples included with APBS (e.g.,
				<code class="filename">solv</code> and
				<code class="filename">ionize</code>) also demonstrate
				solvation energy calculations.  
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Note that, as molecules get larger, it is
					important to examine the sensitivity of
					the calculated solvation energies with
					respect to grid spacings and
					dimensions.</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id442864"></a>4.2. Apolar solvation</h2></div></div></div><p>Referring back to the full free energy cycle in <a href="#solvation-cycle-full" title="Figure 4.1. Full solvation energy cycle.  This cycle incorporates several processes into the solvation energy (step 1).  Step 2  indicates charging of the solute in solution (e.g., inhomogeneous dielectric,  ions present).  Step 3 indicates the introduction of attractive solute-solvent dispersive interaction interactions (e.g., an integral of Weeks-Chandler-Andersen interactions over the solvent-accessible volume).  Step 4 indicates the introduction of repulsive solute-solvent interaction (e.g., cavity formation).  Steps 5 and 6 are basically null steps although they could be used to offset unwanted energies added in Steps 3 and 4 above.  Finally, Step 6 represents the charging of the solute in a vacuum or homogeneous dielectric environment in the absence of mobile ions.">Figure 4.1, “Full
					solvation energy cycle”</a>, the nonpolar solvation free energy is usually represented by the energy changes in Steps 3 through 5:
				</p><div class="informalequation"><div><img src="images/nonpolar-solvation-equation.png" /></div></div><p>
				where Step 4 represents the energy of creating a cavity in solution and Steps 3-5 is the energy associated with dispersive interactions between the solute and solvent.
				There are many possible choices for modeling this nonpolar solvation process.  APBS implements a relatively general model described by <a href="http://dx.doi.org/10.1073/pnas.0600118103" target="_top">Wagoner and Baker (PNAS 2006)</a> and references therein.  
				The implementation and invocation of this model is described in more detail in <a href="../user-guide/index.html#apolar" target="_top">the APBS user guide</a>.
			</p><p>
				Our basic model for the cavity creation term (Step 4) is motivated by scaled particle theory and has the form
				</p><div class="informalequation"><div><img src="images/nonpolar-solvation-cavity-equation.png" /></div></div><p>
				where p is the solvent pressure (<code class="literal">press</code> keyword in APBS), Δ V is the solvent-accessible volume of the solute, γ is the solvent surface tension (<code class="literal">gamma</code> keyword in APBS), and Δ A is the solvent-accessible surface area of the solute.
			</p><p>
				Our basic model for the dispersion terms (Steps 3 and 5) follow a Weeks-Chandler-Anderson framework as proposed by Levy, Zhang, and Gallicchio (<a href="http://dx.doi.org/10.1002/jcc.10045" target="_top">J Comput Chem, 2002</a>):
				</p><div class="informalequation"><div><img src="images/nonpolar-solvation-dispersion-equation.png" /></div></div><p>
				where ρ is the bulk solvent density (<code class="literal">bconc</code> keyword in APBS), Ω is the problem domain, u<sup>(att)</sup>(y) is the attractive dispersion interaction between the solute and the solvent at point y with dispersive Lennard-Jones parameters specified in APBS parameter files, and θ(y) describes the solvent accessibility of point y.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
					The ability to independently adjust <code class="literal">press</code>, <code class="literal">gamma</code>, and <code class="literal">bconc</code> means that the general nonpolar solvation model presented above can be easily adapted to other popular nonpolar solvation models.
					For example, setting <code class="literal">press</code> and <code class="literal">bconc</code> to zero yields a typical solvent-accessible surface area model.
				</p></td></tr></table></div><p>
				Unlike the Born ion, there are no good simple examples for demonstrating these types of nonpolar calculations.  APBS includes several examples of calculations using the apolar model above.  Interested readers should examine the <code class="filename">alkanes</code> apolar example provided with APBS.
			</p></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="binding-sect"></a>Chapter 5. How do I calculate a binding energy?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#binding-solvation">5.1.  Solvation energy contributions to binding
			</a></span></dt><dt><span class="sect1"><a href="#binding-coulombic">5.2. Including Coulombic contributions</a></span></dt><dt><span class="sect1"><a href="#binding-ligand">5.3. Hey! You don't have any parameters for my ligand!</a></span></dt><dt><span class="sect1"><a href="#binding-example">5.4. A ligand binding example</a></span></dt></dl></div><p> In general, implicit solvent models are used to
			calculation the contribution of
			<span class="emphasis"><em>solvation</em></span> to binding free
			energies.  Additional binding free energy contributions
			(molecular mechanics energies, entropic changes, etc.)
			must be calculated separately and are not discussed in
			this tutorial.  One exception is the inclusion of
			intermolecular Coulombic interations; we'll discuss how
			these can be calculated in APBS <a href="#binding-coulomb">below</a>. </p><p> Our framework for calculating solvation contributions to
			binding free energies is shown in <a href="#binding-cycle" title="Figure 5.1.  Binding free energy cycle illustrating&#10;&#9;&#9;&#9;&#9;binding in terms of transfer free energies from&#10;&#9;&#9;&#9;&#9;a homogeneous dielectric environment (where&#10;&#9;&#9;&#9;&#9;interactions are described by Coulomb's law) to &#10;&#9;&#9;&#9;&#9;an inhomogeneous dielectric environment with&#10;&#9;&#9;&#9;&#9;differing internal (green) and external (cyan)&#10;&#9;&#9;&#9;&#9;dielectric constants.  The binding&#10;&#9;&#9;&#9;&#9;(dissociation) free energy is depicted in Step&#10;&#9;&#9;&#9;&#9;3.">Figure 5.1, “ Binding free energy cycle
				”</a>.
			</p><div class="figure"><a id="binding-cycle"></a><p class="title"><b>Figure 5.1.  Binding free energy cycle illustrating
				binding in terms of transfer free energies from
				a homogeneous dielectric environment (where
				interactions are described by Coulomb's law) to 
				an inhomogeneous dielectric environment with
				differing internal (green) and external (cyan)
				dielectric constants.  The binding
				(dissociation) free energy is depicted in Step
				3.</b></p><div class="figure-contents"><div><img src="images/binding-cycle.png" alt="Binding free energy cycle illustrating binding in terms of transfer free energies from a homogeneous dielectric environment (where interactions are described by Coulomb's law) to an inhomogeneous dielectric environment with differing internal (green) and external (cyan) dielectric constants. The binding (dissociation) free energy is depicted in Step 3." /></div></div></div><p><br class="figure-break" />
			The binding free energy is given by <a href="#binding-cycle-eqn" title="Equation 5.1.  Binding free energy formula based on&#10;&#9;&#9;&#9;&#9;&#9;Figure 5.1, “ Binding free energy cycle&#10;&#9;&#9;&#9;&#9;”. ">Equation 5.1, “ Binding free energy formula
				”</a>.
			</p><div class="equation"><a id="binding-cycle-eqn"></a><p class="title"><b>Equation 5.1.  Binding free energy formula based on
					<a href="#binding-cycle" title="Figure 5.1.  Binding free energy cycle illustrating&#10;&#9;&#9;&#9;&#9;binding in terms of transfer free energies from&#10;&#9;&#9;&#9;&#9;a homogeneous dielectric environment (where&#10;&#9;&#9;&#9;&#9;interactions are described by Coulomb's law) to &#10;&#9;&#9;&#9;&#9;an inhomogeneous dielectric environment with&#10;&#9;&#9;&#9;&#9;differing internal (green) and external (cyan)&#10;&#9;&#9;&#9;&#9;dielectric constants.  The binding&#10;&#9;&#9;&#9;&#9;(dissociation) free energy is depicted in Step&#10;&#9;&#9;&#9;&#9;3.">Figure 5.1, “ Binding free energy cycle
				”</a>. </b></p><div class="equation-contents"><div><img src="images/binding-cycle-eqn.png" /></div></div></div><p><br class="equation-break" />
			The following sections provide more detail on
			calculating individual terms of this equation.
		</p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="binding-solvation"></a>5.1.  Solvation energy contributions to binding
			</h2></div></div></div><p> If we're just interested in calculating the solvation
				contributions to binding (steps 4 and 2 in <a href="#binding-cycle" title="Figure 5.1.  Binding free energy cycle illustrating&#10;&#9;&#9;&#9;&#9;binding in terms of transfer free energies from&#10;&#9;&#9;&#9;&#9;a homogeneous dielectric environment (where&#10;&#9;&#9;&#9;&#9;interactions are described by Coulomb's law) to &#10;&#9;&#9;&#9;&#9;an inhomogeneous dielectric environment with&#10;&#9;&#9;&#9;&#9;differing internal (green) and external (cyan)&#10;&#9;&#9;&#9;&#9;dielectric constants.  The binding&#10;&#9;&#9;&#9;&#9;(dissociation) free energy is depicted in Step&#10;&#9;&#9;&#9;&#9;3.">Figure 5.1, “ Binding free energy cycle
				”</a>), then we simply need
				to follow the instructions from <a href="#solvation-sect" title="Chapter 4. How do I calculate a solvation energy?">Chapter 4, <i>How do I calculate a solvation energy?</i></a> for the complex and
				isolated components.  The solvation energy contribution
				to the binding is then given by <a href="#binding-solvation-eq" title="Equation 5.2.  Solvation contributions to the binding&#10;&#9;&#9;&#9;&#9;&#9;&#9;free energy for a two-component complex&#10;&#9;&#9;&#9;&#9;&#9;&#9;of molecules &quot;mol 1&quot; and &quot;mol 2&quot;.&#10;&#9;&#9;&#9;&#9;&#9;&#9;Refer to Figure 5.1, “ Binding free energy cycle&#10;&#9;&#9;&#9;&#9;” for numbering.">Equation 5.2, “ Solvation contributions to the binding
						free energy ”</a>.  
				</p><div class="equation"><a id="binding-solvation-eq"></a><p class="title"><b>Equation 5.2.  Solvation contributions to the binding
						free energy for a two-component complex
						of molecules "mol 1" and "mol 2".
						Refer to <a href="#binding-cycle" title="Figure 5.1.  Binding free energy cycle illustrating&#10;&#9;&#9;&#9;&#9;binding in terms of transfer free energies from&#10;&#9;&#9;&#9;&#9;a homogeneous dielectric environment (where&#10;&#9;&#9;&#9;&#9;interactions are described by Coulomb's law) to &#10;&#9;&#9;&#9;&#9;an inhomogeneous dielectric environment with&#10;&#9;&#9;&#9;&#9;differing internal (green) and external (cyan)&#10;&#9;&#9;&#9;&#9;dielectric constants.  The binding&#10;&#9;&#9;&#9;&#9;(dissociation) free energy is depicted in Step&#10;&#9;&#9;&#9;&#9;3.">Figure 5.1, “ Binding free energy cycle
				”</a> for numbering.</b></p><div class="equation-contents"><div><img src="images/binding-solvation.png" /></div></div></div><p><br class="equation-break" />
				This solvation energy contribution can be decomposed
				into polar and nonpolar parts as outlined in <a href="#solvation-sect" title="Chapter 4. How do I calculate a solvation energy?">Chapter 4, <i>How do I calculate a solvation energy?</i></a>.
			</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="binding-coulombic"></a>5.2. Including Coulombic contributions</h2></div></div></div><p><a id="binding-coulomb"></a> To complete the binding
				free energy cycle (see <a href="#binding-cycle" title="Figure 5.1.  Binding free energy cycle illustrating&#10;&#9;&#9;&#9;&#9;binding in terms of transfer free energies from&#10;&#9;&#9;&#9;&#9;a homogeneous dielectric environment (where&#10;&#9;&#9;&#9;&#9;interactions are described by Coulomb's law) to &#10;&#9;&#9;&#9;&#9;an inhomogeneous dielectric environment with&#10;&#9;&#9;&#9;&#9;differing internal (green) and external (cyan)&#10;&#9;&#9;&#9;&#9;dielectric constants.  The binding&#10;&#9;&#9;&#9;&#9;(dissociation) free energy is depicted in Step&#10;&#9;&#9;&#9;&#9;3.">Figure 5.1, “ Binding free energy cycle
				”</a>), we need to add
				intermolecular Coulombic contributions to the
				solvation energy change upon binding to get the
				total electrostatic/solvent contribution to the
				binding free energy.  In particular, we're
				interested in the change in Coulombic
				electrostatic energy upon binding, as given by
				<a href="#binding-coulomb-eq" title="Equation 5.3.  Coulombic contributions to the binding&#10;&#9;&#9;&#9;&#9;&#9;&#9;free energy for a two-component complex&#10;&#9;&#9;&#9;&#9;&#9;&#9;of molecules &quot;mol 1&quot; and &quot;mol&#10;&#9;&#9;&#9;&#9;&#9;&#9;2&quot;.  See Equation 5.1, “ Binding free energy formula&#10;&#9;&#9;&#9;&#9;”&#10;&#9;&#9;&#9;&#9;&#9;&#9;for numbering.">Equation 5.3, “ Coulombic contributions to the binding
						free energy ”</a>.
				</p><div class="equation"><a id="binding-coulomb-eq"></a><p class="title"><b>Equation 5.3.  Coulombic contributions to the binding
						free energy for a two-component complex
						of molecules "mol 1" and "mol
						2".  See <a href="#binding-cycle-eqn" title="Equation 5.1.  Binding free energy formula based on&#10;&#9;&#9;&#9;&#9;&#9;Figure 5.1, “ Binding free energy cycle&#10;&#9;&#9;&#9;&#9;”. ">Equation 5.1, “ Binding free energy formula
				”</a>
						for numbering.</b></p><div class="equation-contents"><div><img src="images/binding-coulomb.png" /></div></div></div><p><br class="equation-break" />
				Each of the ΔG<sub>coul</sub>
				quantities in <a href="#binding-coulomb-eq" title="Equation 5.3.  Coulombic contributions to the binding&#10;&#9;&#9;&#9;&#9;&#9;&#9;free energy for a two-component complex&#10;&#9;&#9;&#9;&#9;&#9;&#9;of molecules &quot;mol 1&quot; and &quot;mol&#10;&#9;&#9;&#9;&#9;&#9;&#9;2&quot;.  See Equation 5.1, “ Binding free energy formula&#10;&#9;&#9;&#9;&#9;”&#10;&#9;&#9;&#9;&#9;&#9;&#9;for numbering.">Equation 5.3, “ Coulombic contributions to the binding
						free energy ”</a> is the
				sum of pairwise Coulombic interactions between
				all atoms in the molecule (or complex)
				<span class="emphasis"><em>for a particular uniform
					dielectric</em></span>.  In order to
				combine these Coulombic binding energies with
				the solvation energies described <a href="#binding-solvation" title="5.1.  Solvation energy contributions to binding">above</a>,
				we need to make sure consistent dielectric
				constants are used.  In particular, Coulombic
				interactions should be calculated using the
				same uniform dielectric constant as the
				reference state of the solvation energy above.
				For example, if solvation energies are
				calculated for transfering a protein from a
				medium with uniform dielectric of
				ε<sub>in</sub>
				to a medium with internal dielectric
				ε<sub>in</sub>
				and external dielectric 
				ε<sub>out</sub>, 
				then Coulombic energies should
				be calculated using a dielectric of
				ε<sub>in</sub>.
				The APBS accessory program
				<code class="filename">tools/manip/coulomb</code> was
				created to help with the calculation of these
				individual per-molecule Coulombic energies.
				Given a PQR file as input, the
				<code class="filename">tools/manip/coulomb</code>
				program calculates Coulombic energies for a
				vacuum dielectric (e.g., a uniform dielectric
				of 1).  If the reference dielectric is
				ε<sub>in</sub>, then all
				energies returned by 
				<code class="filename">tools/manip/coulomb</code>
				need to be divided by 
				ε<sub>in</sub>.
			</p><p>
				With the appropriate dielectric constant of
				ε<sub>in</sub> used
				for the Coulombic binding energy, a total
				electrostatic/solvation free energy can be
				calculated from <a href="#binding-cycle-eqn-2" title="Equation 5.4.  Binding free energy ">Equation 5.4, “ Binding free energy ”</a>.
				<a href="#binding-cycle-eqn" title="Equation 5.1.  Binding free energy formula based on&#10;&#9;&#9;&#9;&#9;&#9;Figure 5.1, “ Binding free energy cycle&#10;&#9;&#9;&#9;&#9;”. ">Equation 5.1, “ Binding free energy formula
				”</a>, 
				<a href="#binding-solvation-eq" title="Equation 5.2.  Solvation contributions to the binding&#10;&#9;&#9;&#9;&#9;&#9;&#9;free energy for a two-component complex&#10;&#9;&#9;&#9;&#9;&#9;&#9;of molecules &quot;mol 1&quot; and &quot;mol 2&quot;.&#10;&#9;&#9;&#9;&#9;&#9;&#9;Refer to Figure 5.1, “ Binding free energy cycle&#10;&#9;&#9;&#9;&#9;” for numbering.">Equation 5.2, “ Solvation contributions to the binding
						free energy ”</a>, and
				<a href="#binding-coulomb-eq" title="Equation 5.3.  Coulombic contributions to the binding&#10;&#9;&#9;&#9;&#9;&#9;&#9;free energy for a two-component complex&#10;&#9;&#9;&#9;&#9;&#9;&#9;of molecules &quot;mol 1&quot; and &quot;mol&#10;&#9;&#9;&#9;&#9;&#9;&#9;2&quot;.  See Equation 5.1, “ Binding free energy formula&#10;&#9;&#9;&#9;&#9;”&#10;&#9;&#9;&#9;&#9;&#9;&#9;for numbering.">Equation 5.3, “ Coulombic contributions to the binding
						free energy ”</a> as
				</p><div class="equation"><a id="binding-cycle-eqn-2"></a><p class="title"><b>Equation 5.4.  Binding free energy </b></p><div class="equation-contents"><div><img src="images/binding-cycle-eqn-2.png" /></div></div></div><p><br class="equation-break" />
			</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="binding-ligand"></a>5.3. Hey! You don't have any parameters for my ligand!</h2></div></div></div><p><a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a> can now (as of version 1.2.0) parameterize ligands, thanks to new features developed in collaboration with the Jens Nielsen group.  Please visit the PDB2PQR <a href="http://pdb2pqr.sf.net/" target="_top">homepage</a> for more details.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="binding-example"></a>5.4. A ligand binding example</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="forces-sect"></a>Chapter 6. How do I calculate solvation
forces?</h2></div></div></div><p>
			APBS provides force calculations for both polar and nonpolar solvation following the same procedures used in <a href="#solvation-sect" title="Chapter 4. How do I calculate a solvation energy?">Chapter 4, <i>How do I calculate a solvation energy?</i></a>.
			In general, forces can be obtained by modifying input files used for solvation energy calculations to include <code class="literal">calcforce total</code> (for total forces on the entire solute) or <code class="literal">calcforce comps</code> to obtain detailed force information for each atom.
			It is important to note that, like solvation energy calculations, "self-interaction" terms must be removed (cf. the <a href="#born-input" title="Example 4.2. Example born input file">Example 4.2, “Example born input file”</a> example).
		</p></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="pka-sect"></a>Chapter 7. How do I calculate a pK<sub>a</sub>?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#overview-sect">7.1. Overview</a></span></dt><dt><span class="sect1"><a href="#pka-introduction-sect">7.2. Introduction</a></span></dt><dt><span class="sect1"><a href="#id444444">7.3. Application to lysozyme</a></span></dt></dl></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png" /></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>This tutorial was prepared with Dave Sept as part of a lab for a
				biomolecular simulation class.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial covers <span class="emphasis"><em>Poisson-Boltzmann</em></span> methods
				for determining biomolecule pK<sub>a</sub> values.  Other methods for pK<sub>a</sub>
				and titration state determination are given in the <a href="http://pdb2pqr.sourceforge.net" target="_top">PDB2PQR</a> <a href="http://pdb2pqr.sourceforge.net/examples/" target="_top">examples</a>.</p></td></tr></table></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="overview-sect"></a>7.1. Overview</h2></div></div></div><p><b>Why pK<sub>a</sub> calculations? </b>
				Although pK<sub>a</sub> calculations may not seem like the most routine applications for demonstrating continuum electrostatics concepts, they have important scientific and teaching value.  From a scientific standpoint, pK<sub>a</sub> values are important determinants of biomolecular (particularly enzymatic) function and can be used to assess functional activity and identify active sites.  From a pedagogical perspective, pK<sub>a</sub> calculations require all of the important continuum electrostatics concepts and therefore serve as a "self-contained" introduction to solvation and binding energies.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial covers <span class="emphasis"><em>Poisson-Boltzmann</em></span> methods for determining biomolecule pK<sub>a</sub> values.  Other methods for pK<sub>a</sub> and titration state determination are given in the <a href="http://pdb2pqr.sourceforge.net" target="_top">PDB2PQR</a> <a href="http://pdb2pqr.sourceforge.net/examples/" target="_top">examples</a>.  Comparison with PDB2PQR results can provide hours of additional entertainment.
					</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pka-introduction-sect"></a>7.2. Introduction</h2></div></div></div><p> This is a very brief introduction to the concepts behind biomolecular pK<sub>a</sub>s and titration states.  More information can be obtained from most biochemistry or biophysics textbooks as well as some of the original articles on pK<sub>a</sub> evaluation
				<sup>[<a id="pKa-refs" href="#ftn.pKa-refs">6</a>]</sup>.
			</p><p>Recall that the acid dissociation constant K<sub>a</sub> describes the dissocation of an acid into its components:
				</p><div class="informalequation"><div class="mediaobject" align="center"><img src="images/Ka_chem_eqn.png" align="middle" /></div></div><p>
				by way of the activities
				</p><div class="informalequation"><div class="mediaobject" align="center"><img src="images/Ka_act_eqn.png" align="middle" /></div></div><p>
				Under “<span class="quote">conditions of ideality,</span>”
				<sup>[<a id="id443797" href="#ftn.id443797">7</a>]</sup>
				activities can be replaced with concentrations to give
				</p><div class="informalequation"><div class="mediaobject" align="center"><img src="images/Ka_conc_eqn.png" align="middle" /></div></div><p>
				You should also recall that chemical equilibrium constants can be related to free energies by
				</p><div class="informalequation"><div class="mediaobject" align="center"><img src="images/DaG_def.png" align="middle" /></div></div><p>
				However, chemists found it easier to use base-10 logarithms than natural logarithms for measuring pH, therefore the pK<sub>a</sub> is defined as
				</p><div class="informalequation"><div class="mediaobject" align="center"><img src="images/pKa_def.png" align="middle" /></div></div><p>
			</p><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id443865"></a>7.2.1. Amino acid model pK<sub>a</sub> values </h3></div></div></div><p>In many calculations, pK<sub>a</sub> values are assigned based on model values for amino acid side chains to mimic
					</p><div class="informalequation"><div class="mediaobject" align="center"><img src="images/Ka_model_chem_eqn.png" align="middle" /></div></div><p>
					for an <span class="emphasis"><em>isolated</em></span> amino acid in solution.  Some model pK<sub>a</sub> values are given in <a href="#tab:model_pka" title="Table 7.1. Model amino acid pKa values for common titratable groups; data from Nielsen et al (see footnote) ">Table 7.1, “Model amino acid pK<sub>a</sub> values for common titratable groups; data from Nielsen et al (see footnote) ”</a>.
					</p><div class="table"><a id="tab:model_pka"></a><p class="title"><b>Table 7.1. Model amino acid pK<sub>a</sub> values for common titratable groups; data from Nielsen et al (see <a href="#pKa-refs">footnote</a>) </b></p><div class="table-contents"><table summary="Model amino acid pKa values for common titratable groups; data from Nielsen et al (see footnote) " border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Amino acid</th><th>Model pK<sub>a</sub></th></tr></thead><tbody><tr><td>Arginine</td><td>13.0</td></tr><tr><td>Aspartic acid</td><td>4.0</td></tr><tr><td>Cysteine</td><td>8.7</td></tr><tr><td>C-terminus</td><td>3.8</td></tr><tr><td>Glutamic acid</td><td>4.4</td></tr><tr><td>Histidine</td><td>6.3</td></tr><tr><td>Lysine</td><td>10.4</td></tr><tr><td>N-terminus</td><td>8.0</td></tr><tr><td>Tyrosine</td><td>9.6</td></tr></tbody></table></div></div><p><br class="table-break" />
				</p><p> As we'll see in the next section, these model values provide the basis for calculating pK<sub>a</sub> values in proteins. </p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id444072"></a>7.2.2.  pK<sub>a</sub> values in proteins </h3></div></div></div><p> The role of the model pK<sub>a</sub> values introduced in the previous sections is to move all the chemical (bond making and breaking) complexity of protonation into the model values.  In particular, pK<sub>a</sub> values in proteins are calculated as pertubations of the model compounds according to the free energy cycles shown below.  </p><p> The pK<sub>a</sub> for the amino acid in the context of the protein is given by the free energy cycle:
					</p><div class="informalfigure"><a id="fig:pKa_cycle"></a><div class="mediaobject" align="center"><img src="images/Ka_protein_chem_eqn.png" align="middle" /></div></div><p>
					We are interested in determining the unknown Δ<sub>a</sub>G<sub>HA</sub> from the known model Δ<sub>a</sub>G<sub>HA,model</sub> and the unknown Δ<sub>xfer</sub>G<sub>HA</sub> and Δ<sub>xfer</sub>G<sub>A-</sub> according to:
					</p><div class="equation"><a id="eqn:DaG"></a><p class="title"><b>Equation 7.1. Acid dissociation free energy</b></p><div class="equation-contents"><div class="mediaobject" align="center"><img src="images/DaG_from_cycle.png" align="middle" /></div></div></div><p><br class="equation-break" />
				</p><p> In general, the quantities Δ<sub>xfer</sub>G<sub>HA</sub> and Δ<sub>xfer</sub>G<sub>A-</sub> are obainted from a computational approach.  Nearly any free energy calculation method could be used to obtain these energies according to a scheme where the (de)solvation energies of the charged and uncharged amino acids are calculated according to:
					</p><div class="figure"><a id="fig:pKa_cycle_protein"></a><p class="title"><b>Figure 7.1. pK<sub>a</sub> perturbation free energy cycle schematic</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/pKa_protein_cycle.png" align="middle" alt="pKa perturbation free energy cycle schematic" /></div></div></div><p><br class="figure-break" />
					Note that these energies have all assumed the same background state of the protein for the calculations; in other words, the same states are used for other titratable groups in the protein for charged and uncharged amino acid states.  We'll discuss the implications of this assumption a bit later in this tutorial.
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id444244"></a>7.2.3. Continuum electrostatics methods for pK<sub>a</sub> calculations in proteins</h3></div></div></div><p> Although nearly any free energy method could be used to evaluate the energies of transferring the protonated and unprotonated amino acids from solution into the protein environment, continuum electrostatics offer a (usually) satisfying compromise between accuracy and computational efficiency.  </p><p> The transfer free energies to be calculated, Δ<sub>xfer</sub>G<sub>HA</sub> and Δ<sub>xfer</sub>G<sub>A-</sub>, can be determined from Poisson-Boltzmann (PB) energies.  In particular, these energies can be calculated as effective “<span class="quote">binding energy calculations</span>” similar to those covered in the APBS examples and tutorial:
					</p><div class="equation"><a id="eqn:dG_xfer"></a><p class="title"><b>Equation 7.2. Transfer free energy</b></p><div class="equation-contents"><div class="mediaobject" align="center"><img src="images/dG_xfer_eqn.png" align="middle" /></div></div></div><p><br class="equation-break" />
					where
					</p><div class="itemizedlist"><ul type="disc"><li><p> G<sub>protein with charged X</sub> is the electrostatic energy of the protein with group X bound and all charges on X set to their normal values.</p></li><li><p> G<sub>protein with uncharged X</sub> is the electrostatic energy of the protein with group X bound and all charges on X set to zero.</p></li><li><p> G<sub>charged X in solution</sub> is the electrostatic energy of group X in solution with all charges set to their normal values.</p></li></ul></div><p>
				</p><p> Note that, as with binding energies, <a href="#eqn:dG_xfer" title="Equation 7.2. Transfer free energy">Equation 7.2, “Transfer free energy”</a> can be evaluated two ways: 
					</p><div class="itemizedlist"><a id="list:methods"></a><p class="title"><b>Ways to evaluate transfer free energies</b></p><ul type="disc"><li><p> Directly in a PB equation by computing the difference of <span class="emphasis"><em>total electrostatic energies</em></span> (including self energies) from PB calculations for each of the states.  In order for this to work, all conformations/grid positions/charge states must be the same in each PB calculation.  </p></li><li><p> Indirectly through PB calculations of solvation free energies and Coulomb's law calculations (in a dielectric ε<sub>p</sub>) of electrostatic interaction energies.  <span class="emphasis"><em>For a sufficiently fine grid</em></span>, this method is much more stable.  </p></li></ul></div><p>
					Both of these methods can be combined, via free energy cycles, to give the desired Δ<sub>xfer</sub>G<sub>X</sub>.  However, when care is taken to use the same grids and conformations for all calculations, the direct method using total electrostatic energies is usually the most efficient.  </p><p> Note that none of the methods discussed above have explicitly allowed for changes in titration state of other groups in the protein during protonation/deprotonation of the acid group of interest.  Additionally, none of these methods explicitly provide for conformational changes in the protein coupled to protonation/deprotonoation.  As such, we cannot claim to be computing true pK<sub>a</sub> values with this method.  Instead, we are calculating so-called <em class="wordasword">intrinsic</em> pK<sub>a</sub> values.  </p></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id444444"></a>7.3. Application to lysozyme</h2></div></div></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id444450"></a>7.3.1. Background</h3></div></div></div><p> Hen egg white lysozyme (HEWL) is a very popular system for pK<sub>a</sub> calculations as it has a number of interesting values for its titratable residues.  Early pK<sub>a</sub> work on this enzyme is presented in <a href="http://pubs.acs.org/cgi-bin/searchRedirect.cgi/bichaw/1972/11/i11/pdf/bi00761a029.pdf" target="_top">Tanford C, Roxby R.  Interpretation of protein titration curves.  Application to lysozyme.  Biochemistry.  11 (11), 2192-8, 1972</a> which also contains the pK<sub>a</sub> values used in this lab.  More recent pK<sub>a</sub> calculations and a review of some of the methodology can be found in <a href="http://www3.interscience.wiley.com/cgi-bin/abstract/78505732/ABSTRACT" target="_top">Nielsen JE, Vriend G.  Optimizing the hydrogen-bond network in Poisson-Boltzmann equation-based pk(a) calculations.  Proteins-Structure Function and Genetics.  43 (4), 403-12, 2001</a>.  Finally, the biological relevance of lysozyme is briefly reviewed at <a href="http://en.wikipedia.org/wiki/Lysozyme" target="_top">Wikipedia</a>.  </p><p> HEWL has two active site residues GLU 35 and ASP 52 whose titration states determine the catalytic competency of the enzyme:
					</p><div class="figure"><a id="id444515"></a><p class="title"><b>Figure 7.2. Active site of HEWL </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/lysozyme_mech.png" align="middle" alt="Active site of HEWL" /></div></div></div><p><br class="figure-break" />
					In particular, the enzyme is only active when ASP 52 is ionized (pK<sub>a</sub> ≈ 1.2) and GLU 35 is neutral (pK<sub>a</sub> = 6.3).  </p><p>Additionally, lysozyme has ASP 66 with a pK<sub>a</sub> of 6.6 and HIS 15 with a pK<sub>a</sub> of 5.7.</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id444566"></a>7.3.2. Overview and disclaimer</h3></div></div></div><p>In what follows, we will demonstrate the steps for determining the intrinsic pK<sub>a</sub> of GLU35.  However, this actually doesn't work very well (you'll need to decide why!).  Therefore, it is important that you also follow the same procedure for HIS15 and ASP66 to get better examples of <span class="emphasis"><em>working</em></span> continuum solvent pK<sub>a</sub> calculations.</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id444595"></a>7.3.3. Preparing the PDB file</h3></div></div></div><p> Download the PDB entry <a href="http://www.rcsb.org/pdb/cgi/explore.cgi?pdbId=2LZT" target="_top">2LZT</a> from the PDB; save it as <code class="filename">2LZT-GLU35.pdb</code>.  If you have time, you should also visit the <a href="http://www.ebi.ac.uk/thornton-srv/databases/cgi-bin/pdbsum/GetPage.pl?pdbcode=2lzt" target="_top">PDBSum</a> analysis page as well for additional information about the structure.  </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning: Problems with explicit water!"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left"><a id="warn:water"></a>Problems with explicit water!</th></tr><tr><td align="left" valign="top"><p> It is <span class="emphasis"><em>very</em></span> important that you remove all explicit water from the PDB file before proceeding. (Why?) </p></td></tr></table></div><p> We're going to need to generate a protonated form of GLU 35 to perform our pK<sub>a</sub> calculations.  We will do this with the <a href="http://pdb2pqr.sourceforge.net/" target="_top">PDB2PQR web service</a>.  PDB2PQR “<span class="quote">cleans up</span>” PDB files for electrostatics calculations by performing a number of operations described on the <a href="http://pdb2pqr.sourceforge.net/" target="_top">PDB2PQR homepage</a>.  </p><p> Unless otherwise directed, PDB2PQR adds hydrogens to residues based on model pK<sub>a</sub> values.  Therefore, we will need to specify the titration state of GLU 35 for our pK<sub>a</sub> calculation by changing the residue name from <code class="varname">GLU</code> to <code class="varname">GLH</code> using <a href="http://www.vim.org/" target="_top">your favorite text editor</a>.  Save the result as <code class="filename">2LZT-GLH35.pdb</code> </p><p> We're now ready to run PDB2PQR to generate protonated versions of our PDB files.  Use the command line version of PDB2PQR or one of the web servers listed on the <a href="http://pdb2pqr.sourceforge.net/" target="_top">PDB2PQR homepage</a> to generate protonoated PQR files for for <code class="filename">2LZT-GLU35.pdb</code> and <code class="filename">2LZT-GLH35.pdb</code>.  Name your results <code class="filename">2LZT-GLU35.pqr</code> and <code class="filename">2LZT-GLH35.pqr</code>, respectively.  Although it is always important to test sensitivity to various force fields, I'd recommend starting with PARSE.  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> You can use PDB2PQR to assign titration states with PROPKA but don't do it for the above steps since we need to set the titration states explicit for our calculations.  </p></td></tr></table></div><p> Recall that we're also going to need the isolated residue for our electrostatics calculations of intrinsic pK<sub>a</sub>.  Use your favorite text editor to extract the entire GLU 35 or GLH 35 residue from <code class="filename">2LZT-GLU35.pqr</code> and <code class="filename">2LZT-GLH35.pqr</code>.  Save the results as <code class="filename">GLU35.pqr</code> and <code class="filename">GLH35.pqr</code>, respectively.  </p><p> Finally, we'll also need to perform electrostatics calculations on HEWL with the uncharged sidechains.  Use your favorite text editor to zero out the charges in <code class="filename">2LZT-GLU35.pqr</code> and <code class="filename">2LZT-GLH35.pqr</code> to create <code class="filename">2LZT-noGLU35.pqr</code> and <code class="filename">2LZT-noGLH35.pqr</code>.  This can be done by setting the second-to-last column in the PQR file to zero; e.g.
					</p><pre class="programlisting">
ATOM    534  N   GLU    35       6.456  16.408  22.487 -0.5163 1.8240
ATOM    535  CA  GLU    35       6.354  15.205  23.349  0.0397 1.9080
ATOM    536  C   GLU    35       6.889  13.941  22.695  0.5366 1.9080
ATOM    537  O   GLU    35       7.705  13.192  23.277 -0.5819 1.6612
ATOM    538  CB  GLU    35       4.906  14.973  23.796  0.0560 1.9080
ATOM    539  CG  GLU    35       4.476  15.932  24.948  0.0136 1.9080
ATOM    540  CD  GLU    35       5.171  15.736  26.255  0.8054 1.9080
ATOM    541  OE1 GLU    35       5.844  14.786  26.570 -0.8188 1.6612
ATOM    542  OE2 GLU    35       5.038  16.682  27.056 -0.8188 1.6612
ATOM    543  H   GLU    35       5.671  16.799  22.056  0.2936 0.6000
ATOM    544  HA  GLU    35       6.856  15.382  24.215  0.1105 1.3870
ATOM    545  HB2 GLU    35       4.318  15.158  23.042 -0.0173 1.4870
ATOM    546  HB3 GLU    35       4.832  14.066  24.142 -0.0173 1.4870
ATOM    547  HG2 GLU    35       4.654  16.857  24.629 -0.0425 1.4870
ATOM    548  HG3 GLU    35       3.500  15.796  25.084 -0.0425 1.4870
					</pre><p>
					might become
					</p><pre class="programlisting">
ATOM    534  N   GLU    35       6.456  16.408  22.487  0.0000 1.8240
ATOM    535  CA  GLU    35       6.354  15.205  23.349  0.0000 1.9080
ATOM    536  C   GLU    35       6.889  13.941  22.695  0.0000 1.9080
ATOM    537  O   GLU    35       7.705  13.192  23.277  0.0000 1.6612
ATOM    538  CB  GLU    35       4.906  14.973  23.796  0.0000 1.9080
ATOM    539  CG  GLU    35       4.476  15.932  24.948  0.0000 1.9080
ATOM    540  CD  GLU    35       5.171  15.736  26.255  0.0000 1.9080
ATOM    541  OE1 GLU    35       5.844  14.786  26.570  0.0000 1.6612
ATOM    542  OE2 GLU    35       5.038  16.682  27.056  0.0000 1.6612
ATOM    543  H   GLU    35       5.671  16.799  22.056  0.0000 0.6000
ATOM    544  HA  GLU    35       6.856  15.382  24.215  0.0000 1.3870
ATOM    545  HB2 GLU    35       4.318  15.158  23.042  0.0000 1.4870
ATOM    546  HB3 GLU    35       4.832  14.066  24.142  0.0000 1.4870
ATOM    547  HG2 GLU    35       4.654  16.857  24.629  0.0000 1.4870
ATOM    548  HG3 GLU    35       3.500  15.796  25.084  0.0000 1.4870
					</pre><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id444836"></a>7.3.4. Setting up the total electrostatic energy calculations</h3></div></div></div><p> We will be using focusing calculations to calculate the electrostatic potential and free energies for the systems of interest.  </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p> In what follows, we are evaluating <span class="emphasis"><em>total</em></span> electrostatic free energies -- e.g., energies which contain charge self-interaction terms.  We will cancel these self-interaction terms in subsequent steps when we calculate solvation or transfer free energies.  Therefore, it is <span class="emphasis"><em>very important</em></span> that you use the same grid parameters (grid centers, dimensions, spacings, etc.) for every calculation.  </p></td></tr></table></div><p> Here is a template input that we will use for each of the solvation energy calculations (download it <a href="examples/pKa/GLU35/apbs-template.in" target="_top">here</a>):
					</p><pre class="programlisting">
read
	mol pqr compound.pqr # This is the compound for which we will calculate solvation energies
	mol pqr ref.pqr      # This is a compound used as a reference for grid centering
end

elec name inhom          
	mg-auto              # Focusing calculations
	dime 129 129 129     # This is a good grid spacing for this system
	cglen 52.0 66.0 79.0 # These are reasonable coarse grid settings for this system (PDB2PQR-recommended)
	fglen 51.0 59.0 67.0 # These are reasonable fine grid settings for this system (PDB2PQR-recommended)
	cgcent mol 2         # Center the grid on the reference molecule
	fgcent mol 2         # Center the grid on the reference molecule
	mol 1
	lpbe
	bcfl sdh
	pdie 20.00
	sdie 78.54
	srfm smol
	sdens 40.0
	chgm spl2
	srad 1.40
	swin 0.30
	temp 298.15
	calcenergy total
	calcforce no
end

# Print the final energy 
print energy inhom end

quit
					</pre><p>
					There are a number of aspects to this input file which are worth noting:
					</p><div class="itemizedlist"><ul type="disc"><li><p> In general, <code class="varname">compound.pqr</code> will change for each calculation but <code class="varname">ref.pqr</code> will not.  Choose one molecule to be <code class="varname">ref.pqr</code> (<code class="filename">2LZT-GLU35.pqr</code> is a good choice) and use it in every calculation.  </p></li><li><p> We are using a solute dielectric constant (ε<sub>p</sub>) of 20 (see <em class="parameter"><code>pdie</code></em>).  This is a common choice for pK<sub>a</sub> since <sup>[<a id="id444934" href="#ftn.id444934">8</a>]</sup> it is thought to implicitly represent internal relaxation and rearrangement of the solute <sup>[<a id="id444943" href="#ftn.id444943">9</a>]</sup>.  </p></li><li><p> We are using a molecular surface (<em class="parameter"><code>srfm smol</code></em>) with a reasonably high density of surface discretization points (<em class="parameter"><code>sdens 40.0</code></em>).  pK<sub>a</sub> and other electrostatics results can be very sensitive to surface choice. </p></li></ul></div><p>
				</p><p> You now have enough information to calculate total electrostatic energies for all of the relevant molecules so far: <code class="filename">2LZT-GLU35.pqr</code>, <code class="filename">2LZT-GLH35.pqr</code>, <code class="filename">2LZT-noGLU35.pqr</code>, <code class="filename">2LZT-noGLH35.pqr</code>, <code class="filename">GLU35.pqr</code>, and <code class="filename">GLH35.pqr</code>.  You should be able to construct APBS input files for each of these systems by modifying the template above.  Once these input files are constructed, you can run the PB calculation by
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>apbs</code></strong> <code class="varname">foo.in</code> | tee <code class="varname">foo.out</code>
</pre><p>
					where <code class="varname">foo.in</code> is the input file of interest and the output is saved in <code class="varname">foo.out</code>. </p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id445056"></a>7.3.5. Setting up the transfer free energy calculations</h3></div></div></div><p> Recall from our <a href="#list:methods">earlier discussion</a> that the transfer free energies can be evaluated in two ways.  It is up to you to decide which method to use; both should give comparable results for a sufficiently fine grid.  As mentioned above, the direct subtraction of total electrostatic energies is usually the most stable route, assuming identical grids and solute conformations are used for all calculations.  </p><p> Any differences in results between these two transfer free energy methods are typically due to a lack of convergence in the calculations and can be resolved by decreasing the grid spacing (e.g., increasing the number of grid points).  </p><p> If you choose to decompose the transfer free energies into solvation and Coulombic energy changes, then you will need to perform two additional electrostatics calculations beyond the APBS calculations outlined in the previous section:
					</p><div class="itemizedlist"><ul type="disc"><li><p> First, you will need to re-run all of your APBS calculations with a homogeneous dielectric ε<sub>s</sub> = ε<sub>p</sub> to calculate solvation energies.  This can be accomplished by appropriate modification of the input files from the previous section.  </p></li><li><p> Second, you will need to calculate Coulombic interaction energies.  The APBS program <span><strong class="command">coulomb</strong></span> will evaluate the Coulomb's law electrostatic energy of a set of charges in a vacuum.  The program's usage is
								</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>coulomb foo.pqr</code></strong>
								</pre><p>
								where <code class="varname">foo.pqr</code> is the particular PQR file you are interested in.
								Note that this program can also be run with no arguments to obtain an expanded list of options.  <span class="emphasis"><em>Don't forget to scale by ε<sub>p</sub>!</em></span> </p></li></ul></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sec:cheat"></a>7.3.6. Putting it all together</h3></div></div></div><p> At this point, you should have everything you need to calculate the intrinsic pK<sub>a</sub> of interest.  However, if you get stuck, I've included some example files here that might be helpful:
					</p><div class="variablelist"><dl><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/GLU35.pqr" target="_top">GLU35.pqr</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/GLH35.pqr" target="_top">GLH35.pqr</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-GLH35.pqr" target="_top">2LZT-GLH35.pqr</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-GLU35.pqr" target="_top">2LZT-GLU35.pqr</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-noGLH35.pqr" target="_top">2LZT-noGLH35.pqr</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-noGLU35.pqr" target="_top">2LZT-noGLU35.pqr</a></code></span></dt><dd><p>PQR files described above</p></dd><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-noGLH35.in" target="_top">2LZT-noGLH35.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-GLH35.in" target="_top">2LZT-GLH35.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/GLH35.in" target="_top">GLH35.in</a></code></span></dt><dd><p>APBS input files needed to calculate the transfer free energy for GLH directly using total electrostatic energies.</p></dd><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-noGLH35-vac.in" target="_top">2LZT-noGLH35-vac.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-GLH35-vac.in" target="_top">2LZT-GLH35-vac.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/GLH35-vac.in" target="_top">GLH35-vac.in</a></code></span></dt><dd><p>Additional APBS input files needed to calculate the transfer free energy for GLH using polar solvation energies.</p></dd><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-noGLU35.in" target="_top">2LZT-noGLU35.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-GLU35.in" target="_top">2LZT-GLU35.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/GLU35.in" target="_top">GLU35.in</a></code></span></dt><dd><p>APBS input files needed to calculate the transfer free energy for GLU directly using total electrostatic energies.</p></dd><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-noGLU35-vac.in" target="_top">2LZT-noGLU35-vac.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/2LZT-GLU35-vac.in" target="_top">2LZT-GLU35-vac.in</a></code>, </span><span class="term"><code class="filename"><a href="examples/pKa/GLU35/GLU35-vac.in" target="_top">GLU35-vac.in</a></code></span></dt><dd><p>Additional APBS input files needed to calculate the transfer free energy for GLU using polar solvation energies.</p></dd><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/run-apbs.sh" target="_top">run-apbs.sh</a></code></span></dt><dd><p><a href="http://www.gnu.org/software/bash/" target="_top">Bash</a> script to run all the APBS input files listed above.  Assumes the <code class="filename">apbs</code> binary is in your <code class="varname">PATH</code>.</p></dd><dt><span class="term"><code class="filename"><a href="examples/pKa/GLU35/run-coul.sh" target="_top">run-coul.sh</a></code></span></dt><dd><p><a href="http://www.gnu.org/software/bash/" target="_top">Bash</a> script to run supporting Coulombic energy calculations for solvation energy-based evaluation of the transfer free energies.  Assumes the APBS <code class="filename">coulomb</code> binary (usually found in <code class="filename">apbs/tools/manip</code>) is in your <code class="varname">PATH</code>.</p></dd></dl></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id445521"></a>7.3.7. What's next?</h3></div></div></div><p>Based on this brief introduction, you should be in a good position to go back and try to evaluate intrinsic pK<sub>a</sub>s for HIS 15 and ASP 66.  How well do your results for those residues agree with experiment?  What's different with those residues?</p><p>So far, we've only examined <span class="emphasis"><em>intrinsic</em></span> pK<sub>a</sub>s in this lab and have ignored coupling between titratable groups.  <a href="http://enzyme.ucd.ie/group_members/jens" target="_top">Jens Nielsen</a> has developed a very nice software package called <a href="http://enzyme.ucd.ie/Science/pKa/pKaTool" target="_top">pKaTool</a> which allows you to explore coupling between titratable sites and its impact on titration events in a protein system.  He has provided a <a href="http://enzyme.ucd.ie/Science/pKa/pKaTool/Documents/pKa_system_BCX.pdf" target="_top">tutorial (PDF)</a> which you can use to explore coupled titration states and use to familiarize yourself with pKaTool.</p></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div class="footnote"><p><sup>[<a id="ftn.pKa-refs" href="#pKa-refs">6</a>] </sup>The following references provide a good introduction to biomolecular pK<sub>a</sub> calculations:
						<div class="itemizedlist"><ul type="disc"><li><p>Bashford D, Karplus M.  pK<sub>a</sub>'s of ionizable groups in proteins: Atomic detail from a continuum electrostatic model.  Biochemistry.  29 (44), 10219-25, 1990.  <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=2271649" target="_top">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=2271649</a> </p></li><li><p>Antosiewicz J, McCammon JA, Gilson MK.  The determinants of pK<sub>a</sub>s in proteins.  Biochemistry.  35 (24), 7819-33, 1996.  <a href="http://pubs.acs.org/cgi-bin/pagelookup?bichaw/35/7819" target="_top">http://pubs.acs.org/cgi-bin/pagelookup?bichaw/35/7819</a></p></li><li><p>Nielsen JE, Vriend G.  Optimizing the hydrogen-bond network in Poisson-Boltzmann equation-based pK<sub>a</sub> calculations.  Proteins-Structure Function and Genetics.  43 (4), 403-12, 2001.  <a href="http://www3.interscience.wiley.com/cgi-bin/abstract/78505732/ABSTRACT" target="_top">http://www3.interscience.wiley.com/cgi-bin/abstract/78505732/ABSTRACT</a> </p></li></ul></div>
					</p></div><div class="footnote"><p><sup>[<a id="ftn.id443797" href="#id443797">7</a>] </sup>Such conditions might happen at extremely low ion and coion concentrations in the absence of other interacting species, etc.  In other words, for real biological systems, these conditions are rarely encountered.</p></div><div class="footnote"><p><sup>[<a id="ftn.id444934" href="#id444934">8</a>] </sup>Start vigorous waving of hands...</p></div><div class="footnote"><p><sup>[<a id="ftn.id444943" href="#id444943">9</a>] </sup>Stop vigorous waving of hands...</p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="parallel-sect"></a>Chapter 8. My calculation requires too much memory!</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#parallel">8.1. Parallel calculations:  an example</a></span></dt><dt><span class="sect1"><a href="#async">8.2. Asynchronous sequential calculations</a></span></dt></dl></div><p> APBS requires approximately 200 B memory per grid point.
		Memory usage can be predicted before performing the
		calculations using the <code class="filename">tools/manip/psize.py</code>
		Python script provided with APBS. </p><p>  If it appears your calculation is going to require more
		memory than is currently available on your system, you
		have a few options:
	</p><div class="itemizedlist"><ul type="disc"><li><p>APBS calculations can be performed in
				parallel across multiple processors
				(hopefully, sharing distributed
				memory!).  This functionality is
				provided by the
				<code class="literal">mg-para</code> keyword
				which is described in more detail in
				the APBS user manual and <a href="#parallel" title="8.1. Parallel calculations: an example">below</a>.  
			</p></li><li><p>APBS calculations can be broken into a
				series of smaller, asynchronous runs
				which (individually) require less
				memory.  This functionality is provided
				by the <code class="literal">mg-para</code>
				<code class="literal">async</code> keyword
				which is described in more detail in
				the APBS user manual and <a href="#async" title="8.2. Asynchronous sequential calculations">below</a>.  
			</p></li><li><p>
				Submit your calculations through <a href="#gemstone-sect" title="Chapter 10. Can I run APBS via the web? (Gemstone)">Gemstone</a>
				to external computational resources.
			</p></li></ul></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="parallel"></a>8.1. Parallel calculations:  an example</h2></div></div></div><p>
			The actin dimer example provided with the APBS
			source code
			(<code class="filename">examples/actin-dimer/complex.pqr</code>)
			is a fairly large system and a good example for
			parallel focusing calculations.  This example
			will use the actin dimer complex PQR file
			<code class="filename"><a href="examples/parallel/complex.pqr" target="_top">complex.pqr</a></code>.
		</p><p>  We're going to use an 8-processor parallel
			calculation to write out the electrostatic
			potential map for this complex.  Each processor
			will solve a portion of the overall problem
			using the parallel focusing method (see <a href="http://dx.doi.org/10.1073/pnas.181342398" target="_top">Baker
				et al, PNAS, 2001</a>) on a
			97<sup>3</sup> mesh with 20%
			overlap between meshes for neighboring
			processors.  An example input file for this
			calculation might look like (download <a href="examples/parallel/apbs.in" target="_top">here</a>):
			<a id="mg-para.in"></a></p><pre class="programlisting">
read 
	mol pqr complex.pqr
end

elec name complex
	mg-para
	ofrac 0.1
	pdime 2 2 2
	dime  97  97  97
	fglen 150 115 160
	cglen 156 121 162
	cgcent mol 1
	fgcent mol 1
	mol 1
	npbe
	bcfl sdh
	ion 1 0.150 2.0
	ion -1 0.150 2.0 
	pdie 2.0
	sdie 78.54
	srfm mol
	chgm spl0
	srad 1.4
	swin 0.3
	sdens 10.0
	temp 298.15
	calcenergy total
	calcforce no
	write pot dx pot
end

quit
			</pre><p>
			where the <code class="literal">pdime 2 2 2</code>
			specifies the 8-processor array dimensions, the
			<code class="literal">ofrac 0.1</code> specifies the 20%
			overlap between processor calculations, and the
			<code class="literal">dime 97 97 97</code> specifies the
			size of <span class="emphasis"><em>each processor's</em></span>
			calculation.  The <code class="literal">write pot dx
				pot</code> instructs APBS to write
			out <a href="../user-guide/index.html#opendx-format" target="_top">OpenDX-format</a>
			maps of the potential to 8 files
			<code class="filename">pot#.dx</code>, where
			<code class="literal">#</code> is the number of the
			particular processor.
		</p><p>
			Running this input file with an MPI-compiled version
			of APBS runs 8 parallel focusing calculations,
			with each calculation generating fine-scale
			solutions on a different region of the
			(<code class="literal">fglen</code>) problem domain.
			Note that 8 separate OpenDX files are written
			by the 8 processors used to perform the
			calculation.  Writing separate OpenDX files
			allows us to avoid communication in the
			parallel run and keeps individual file sizes
			(relatively) small.  Additionally, if a user is
			interested in a specific portion of the problem
			domain, only a few files are needed to get
			local potential information.
		</p><p>
			However, most users are interested in global
			potentials.  For some programs (<a href="http://opendx.org" target="_top">OpenDX</a>,
			<a href="http://www.visualdatatools.com/" target="_top">DataTank</a>),
			the individual potential files can simply be
			read into the program separately and the
			program will reconstruct the global map.
			Most other programs will require the user to
			reassemble the global map first; APBS provides
			the <code class="filename"><a href="../user-guide/index.html" target="_top">mergedx</a></code>
			program for this purpose.
			<code class="filename">mergedx</code> is a simple
			program that allows users to combine several
			OpenDX files from a parallel focusing
			calculation into a single map.  This map can be
			downsampled from the original resolution to
			provide coarser datasets for fast
			visualization, etc.
			For example, the command
			</p><pre class="screen">
<code class="prompt">$</code> mergedx 65 65 65 pot0.dx pot1.dx pot2.dx pot3.dx pot4.dx pot5.dx pot6.dx pot7.dx
			</pre><p>
			will generate a file
			<code class="filename">gridmerged.dx</code>
			which has downsampled the much larger dataset
			contained in the 8 OpenDX files into a
			65<sup>3</sup> file which
			would be suitable for rough visualization.  An
			example of the <code class="filename">mergedx</code>
			output (see <a href="#vmd-isocontour" title="3.1.4.1. Isocontour visualization">Section 3.1.4.1, “Isocontour visualization”</a>
			for methods) is shown in 
			</p><div class="figure"><a id="id445904"></a><p class="title"><b>Figure 8.1. Actin dimer isocontours from
parallel focusing</b></p><div class="figure-contents"><div><img src="images/actin_dimer-iso_trans.jpg" alt="Actin dimer isocontours from parallel focusing" /></div></div></div><p><br class="figure-break" />
				Note that downsampling isn't necessary -- and
				often isn't desirable for high quality
				visualization or quantitative analysis.
			</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="async"></a>8.2. Asynchronous sequential calculations</h2></div></div></div><p>
				The steps described in the <a href="#parallel" title="8.1. Parallel calculations: an example">previous
					section</a> can also be performed
				for systems or binaries which are not equipped
				for parallel calculations via MPI.  In
				particular, you can add 
				</p><pre class="screen">
<strong class="userinput"><code>async</code></strong> <em class="parameter"><code>n</code></em>
				</pre><p>
				to the <code class="literal">ELEC</code>
				<code class="literal">mg-para</code> APBS input file to
				make the single-processor calculation
				masquerade as processor
				<em class="parameter"><code>n</code></em> of a parallel
				calculation.  
			</p><p>
				Scalar maps from asynchronous APBS calculations
				can be combined using the
				<code class="filename">mergedx</code> program as
				described above.  Currently, energies and
				forces from asynchronous APBS calculations need
				to merged manually (e.g., summed) from the
				individual asynchronous calculation output.
				This can be accomplished by simple shell
				scripts.
			</p><p>
				As a specific example, we can modify the <a href="#mg-para.in">input file
					above</a> to include a
				<code class="literal">async 0</code> command in the ELEC
				statement and thus cause APBS to perform the
				operations of the first processor in the
				parallel focusing calculation.  The modified
				input file (available for download <a href="examples/parallel/apbs-async.in" target="_top">here</a>)
				should look like:
				<a id="mg-para-async.in"></a></p><pre class="programlisting">
read 
	mol pqr complex.pqr
end

elec name complex
	mg-para
	ofrac 0.1
	pdime 2 2 2
	async 0
	dime  97  97  97
	fglen 150 115 160
	cglen 156 121 162
	cgcent mol 1
	fgcent mol 1
	mol 1
	npbe
	bcfl sdh
	ion 1 0.150 2.0
	ion -1 0.150 2.0 
	pdie 2.0
	sdie 78.54
	srfm mol
	chgm spl0
	srad 1.4
	swin 0.3
	sdens 10.0
	temp 298.15
	calcenergy total
	calcforce no
	write pot dx pot
end

quit
				</pre><p>
				This should create an OpenDX-format potential
				map called <code class="filename">pot.dx</code>,
				corresponding to the output from processor 0 in
				a parallel focusing calculation.  Performing
				additional APBS calculations with
				<code class="literal">async 1</code>,
				<code class="literal">async 2</code>,
				...,
				<code class="literal">async 7</code>
				will generate the corresponding OpenDX maps for
				the remaining processors of the parallel
				focusing calculations.  These can then be
				reassembled with <code class="filename">mergedx</code>
				as described above.
			</p></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="simulation-sect"></a>Chapter 9. How do I use APBS with my
molecular dynamics program (for MM/PBSA, etc.)?</h2></div></div></div><p>
			Robert Konecny (<a href="http://mccammon.ucsd.edu" target="_top">McCammon group</a>) has developed the <a href="http://mccammon.ucsd.edu/iapbs/" target="_top">iAPBS</a> package which provides a C/C++/FORTRAN interface to APBS for use with AMBER, NAMD, and CHARMM.  More information is available from the iAPBS <a href="http://mccammon.ucsd.edu/iapbs/" target="_top">homepage</a>.
		</p><p>
			APBS also links against developmental versions of the <a href="http://dasher.wustl.edu/tinker/" target="_top">TINKER</a> software package.  Public versions of TINKER with APBS support should be available soon from <a href="http://dasher.wustl.edu/tinker/" target="_top">http://dasher.wustl.edu/tinker/</a>.
		</p></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="gemstone-sect"></a>Chapter 10. Can I run APBS via the web?  (Gemstone) </h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id446166">10.1. Getting Gemstone</a></span></dt><dt><span class="sect1"><a href="#id446191">10.2. Preparing a structure with PDB2PQR</a></span></dt><dt><span class="sect1"><a href="#id446302">10.3. Perform an electrostatics calculation with APBS</a></span></dt></dl></div><p>Yes, you can run APBS via the web, thanks to the <a href="http://gemstone.mozdev.org" target="_top">Gemstone</a>
			service.  This section demonstrates how <a href="http://gemstone.mozdev.org" target="_top">Gemstone</a>
			can be used to perform most APBS calculations commonly
			done through the command-line interface.  Better yet,
			it allows you to use <a href="http://nbcr.net" target="_top">NBCR's</a> resources
			instead of your own!  
		</p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id446166"></a>10.1. Getting Gemstone</h2></div></div></div><p> You need to download and install the Gemstone
				extension for the <a href="http://www.mozilla.com/firefox/" target="_top">Firefox</a>
				web browser from <a href="http://gemstone.mozdev.org" target="_top">http://gemstone.mozdev.org</a>
				before starting this tutorial.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id446191"></a>10.2. Preparing a structure with PDB2PQR</h2></div></div></div><p> We'll start by preparing a structure with <a href="http://pdb2pqr.sf.net" target="_top">PDB2PQR</a>.
				First, you need to download a PDB file from the
				<a href="http://www.pdb.org" target="_top">Protein Data
					Bank</a>.  For the purposes of this
				example, we'll use <a href="http://www.pdb.org/pdb/navbarsearch.do?newSearch=yes&amp;inputQuickSearch=1fas" target="_top">1FAS</a>
				in PDB format (download directly <a href="http://www.pdb.org/pdb/downloadFile.do?fileFormat=pdb&amp;compression=NO&amp;structureId=1FAS" target="_top">here</a>).  </p><p> Open the Gemstone interface through the Firefox
				menu <span class="guimenu">Tools</span> → <span class="guimenuitem">Gemstone</span>.  Select the PDB2PQR
				application through the Gemstone menu
				<span class="guimenu">Utils</span> → <span class="guimenuitem">PDB2PQR</span> on the righthand side of
				the Gemstone screen.  Select the PDB
				file you just downloaded and any other
				options for PDB2PQR of interest.  Your
				screen should look something like:
				</p><div class="figure"><a id="id446273"></a><p class="title"><b>Figure 10.1. Gemstone PDB2PQR calculation</b></p><div class="figure-contents"><div><img src="images/gemstone-pdb2pqr.png" alt="Gemstone PDB2PQR calculation" /></div></div></div><p><br class="figure-break" />
				Go ahead and "Run" the Gemstone
				calculation, check the
				<code class="filename">stdOut</code> and
				<code class="filename">stdErr</code> for any
				warning messages, and download the
				resulting PQR file.  </p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id446302"></a>10.3. Perform an electrostatics calculation with APBS</h2></div></div></div><p>We're now ready to perform an APBS
				calculation of the 1FAS electrostatic
				potential through Gemstone.  Open the
				<span class="guimenu">Chemistry</span> → <span class="guimenuitem">Apbs</span>
				menu on the righthand side of the
				Gemstone screen.  We'll step through
				each of the input tabs in the middle
				pane in the following sections.
			</p><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id446333"></a>10.3.1. Calculation</h3></div></div></div><p>Move to the Calculation tab in
					the middle pane.</p><p>Most of the "Mathematics"
					settings can be left as-is;
					however, feel free to play with
					the discretization and surface
					definitions to see how it
					affects your results.</p><p>Under "Molecules", load the 1FAS
					PQR file you just prepared in
					the previous section.</p><p>Don't select anything under
					"Energy and Force" for this
					calculation.</p><p>At
					this point, your screen should
					look something like this:
					</p><div class="figure"><a id="id446362"></a><p class="title"><b>Figure 10.2. Gemstone APBS/Calculation screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-calculation.png" alt="Gemstone APBS/Calculation screen" /></div></div></div><p><br class="figure-break" />
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id446379"></a>10.3.2. Grid</h3></div></div></div><p>Next, move to the Grid tab in the
					middle pane.</p><p>Under "General", enter 97 for X,
					Y, and Z "Grid points".</p><p>Under "Coarse Grid", choose 100
					for all X, Y, and Z "Lengths".
					Center the mesh on the
					molecule.</p><p>Under "Fine Grid", choose 80 for
					all X, Y, and Z "Lengths".
					Center the mesh on the
					molecule.</p><p>Leave the "Parallel Execution"
					alone for this
					calculation.</p><p>At this point, your screen should
					look something like this:
					</p><div class="figure"><a id="id446409"></a><p class="title"><b>Figure 10.3. Gemstone APBS/Grid screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-grid.png" alt="Gemstone APBS/Grid screen" /></div></div></div><p><br class="figure-break" />
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id446425"></a>10.3.3. Physics</h3></div></div></div><p>Next, move to the Physics tab in
					the middle pane.</p><p>Choose any values you like here;
					the defaults should be fine for
					most visualization
					calculations.</p><p>At this point, your screen should
					look something like this:
					</p><div class="figure"><a id="id446444"></a><p class="title"><b>Figure 10.4. Gemstone APBS/Physics screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-physics.png" alt="Gemstone APBS/Physics screen" /></div></div></div><p><br class="figure-break" />
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id446460"></a>10.3.4. File I/O </h3></div></div></div><p>Next, move to the File I/O tab in
					the middle pane.</p><p>Unless you have other properties
					you wan to visualize, you can
					leave these settings
					as-is.</p><p>At this point, your screen should
					look something like this:
					</p><div class="figure"><a id="id446478"></a><p class="title"><b>Figure 10.5. Gemstone APBS/File I/O screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-file.png" alt="Gemstone APBS/File I/O screen" /></div></div></div><p><br class="figure-break" />
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id446494"></a>10.3.5. Running the calculation</h3></div></div></div><p>Finally, return to the Calculation tab
					and select "Run APBS".  After a while,
					the results will appear under the
					Output tab in the middle pane.  When
					the run is complete, you should see
					something like this:
					</p><div class="figure"><a id="id446506"></a><p class="title"><b>Figure 10.6. Gemstone APBS/Calculation screen (run complete)</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-finished.png" alt="Gemstone APBS/Calculation screen (run complete)" /></div></div></div><p><br class="figure-break" />
					In particular, you should have the
					option to save the potential file
					calculated in this APBS run.  </p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id446524"></a>10.3.6. Other calculations</h3></div></div></div><p>Nearly all of the examples in this
					tutorial can also be performed with
					Gemstone.  Furthermore, input files can
					be uploaded to use Gemstone as a
					"portal" to web services at other
					institutions. </p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="more-sect"></a>Chapter 11. More examples...</h2></div></div></div><p> In addition to the relatively simple applications
			presented here, there are a number of additional
			examples distributed with the APBS software package
			(<a href="http://apbs.sf.net" target="_top">http://apbs.sf.net</a>) which
			include ionization energies, protein-protein
			interactions, parallel calculations, etc.  </p></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="help-sect"></a>Chapter 12. None of this answered my question...</h2></div></div></div><p>Please visit the <a href="http://lists.sourceforge.net/mailman/listinfo/apbs-users" target="_top">APBS-users
				mailing list</a>.  After you've looked for
			the answer to your question in the <a href="http://sourceforge.net/mailarchive/forum.php?forum_id=46597" target="_top">archive</a>,
			please post it to the mailing list. </p></div></div></body></html>
